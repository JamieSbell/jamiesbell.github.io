// Generated by Construct, the game and animation creation tool
// Visit: https://www.construct.net

"use strict";window.i=class{constructor(t,s){this.h=t,this.o=s,this.l=!1,this.u=()=>this.m()}v(){}_(t,s,i,e){this.h.S(this.o,t,s,i,e)}O(t,s,i,e){return this.h.P(this.o,t,s,i,e)}M(t,s,i){this.h.R()?this._(t,s,i):this.h.C()._OnMessageFromDOM({type:"event",component:this.o,handler:t,dispatchOpts:i||null,data:s,responseId:null})}T(t,s){this.h.I(this.o,t,s)}A(t){for(const[s,i]of t)this.T(s,i)}G(){return this.h}F(){return this.o}L(){this.l||(this.h.D(this.u),this.l=!0)}W(){this.l&&(this.h.U(this.u),this.l=!1)}m(){}},window.H=class{constructor(t,s){this.B=t,this.V=s,this.j=-1,this.N=-1/0,this.$=()=>this.Y(),this.X=!1,this.J=!1}K(t){this.J=!!t}Z(){if(-1!==this.j)return;const t=Date.now(),s=t-this.N,i=this.V;s>=i&&this.J?(this.N=t,this.tt()):this.j=self.setTimeout(this.$,Math.max(i-s,4))}tt(){this.X=!0,this.B(),this.X=!1}st(){this.X||(this.it(),this.N=Date.now())}Y(){this.j=-1,this.N=Date.now(),this.tt()}it(){-1!==this.j&&(self.clearTimeout(this.j),this.j=-1)}et(){this.it(),this.B=null,this.$=null}};{class t{constructor(t){this.nt=t,this.ht=!1,this.ot=!0,this.rt=-1,this.ct=-1,this.lt=-1}ut(t){this.ot=!!t}dt(){return this.ot}wt(){return this.ht}ft(){this.ht=!0}yt(){return this.rt}gt(t){this.rt=t}vt(){return this.ct}bt(t){this.ct=t}_t(t){this.lt=t}St(){return this.lt}kt(){return this.nt}}window.Ot=class extends self.i{constructor(t,s){super(t,s),this.Pt=new Map,this.Mt=!0,this.A([["create",t=>this.Rt(t)],["destroy",t=>this.Ct(t)],["set-visible",t=>this.xt(t)],["update-position",t=>this.Tt(t)],["update-state",t=>this.It(t)],["focus",t=>this.At(t)],["set-css-style",t=>this.Et(t)],["set-attribute",t=>this.Gt(t)],["remove-attribute",t=>this.Ft(t)]]),this.Lt("get-element",t=>t)}Dt(t){this.Mt=!!t}Lt(t,s){this.T(t,t=>{const i=t.elementId,e=this.Wt(i);return s(e,t)})}Ut(t){for(const[s,i]of t)this.Lt(s,i)}Rt(s){const i=s.elementId,e=this.Ht(i,s),n=new t(e);this.Pt.set(i,n),e.style.boxSizing="border-box",e.style.display="none",n.ut(s.isVisible);const h=this.Bt(e);h.addEventListener("focus",t=>this.Vt(i)),h.addEventListener("blur",t=>this.jt(i));const o=s.htmlIndex;if(n.gt(o),n._t(s.htmlZIndex),this.Mt){const t=this.G().Nt(o);n.bt(t),this.G().$t(t).appendChild(e)}}Ht(t,s){throw new Error("required override")}zt(t){}Ct(t){const s=t.elementId,i=this.Wt(s);this.zt(i),this.Mt&&i.parentElement.removeChild(i),this.Pt.delete(s)}qt(t,s,i){i||(i={}),i.elementId=s,this._(t,i)}Yt(t,s,i){i||(i={}),i.elementId=s,this.M(t,i)}xt(t){if(!this.Mt)return;const s=this.Pt.get(t.elementId),i=s.kt();s.wt()?i.style.display=t.isVisible?"":"none":s.ut(t.isVisible)}Tt(t){if(!this.Mt)return;const s=this.Pt.get(t.elementId),i=s.kt(),e=this.G();i.style.left=t.left+"px",i.style.top=t.top+"px",i.style.width=t.width+"px",i.style.height=t.height+"px";const n=t.fontSize;null!==n&&(i.style.fontSize=n+"em");const h=t.htmlIndex;s.gt(h);const o=e.Nt(h);o!==s.vt()&&(i.remove(),e.$t(o).appendChild(i),s.bt(o),e.Xt());const r=t.htmlZIndex;r!==s.St()&&(s._t(r),e.Xt()),s.wt()||(s.ft(),s.dt()&&(i.style.display=""))}Jt(){if(this.Mt)for(const t of this.Pt.values()){const s=this.G().Nt(t.yt()),i=t.vt();if(-1!==s&&-1!==i&&s!==i){const i=t.kt();i.remove(),this.G().$t(s).appendChild(i),t.bt(s)}}}Kt(){return this.Mt?[...this.Pt.values()]:null}It(t){const s=this.Wt(t.elementId);this.Zt(s,t)}Zt(t,s){throw new Error("required override")}Bt(t){return t}Vt(t){this.qt("elem-focused",t)}jt(t){this.qt("elem-blurred",t)}At(t){const s=this.Bt(this.Wt(t.elementId));t.focus?s.focus():s.blur()}Et(t){const s=this.Wt(t.elementId),i=t.prop,e=t.val;i.startsWith("--")?s.style.setProperty(i,e):s.style[i]=e}Gt(t){this.Wt(t.elementId).setAttribute(t.name,t.val)}Ft(t){this.Wt(t.elementId).removeAttribute(t.name)}Wt(t){const s=this.Pt.get(t);if(!s)throw new Error(`no element with id ${t}`);return s.kt()}}}{const s=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),i=/android/i.test(navigator.userAgent),e=/safari/i.test(navigator.userAgent)&&!/(chrome|chromium|edg\/|OPR\/|nwjs)/i.test(navigator.userAgent);let n=0;function h(t){const s=document.createElement("script");return s.async=!1,s.type="module",t.Qt?new Promise(i=>{const e="c3_resolve_"+n;++n,self[e]=i,s.textContent=t.ts+`\n\nself["${e}"]();`,document.head.appendChild(s)}):new Promise((i,e)=>{s.onload=i,s.onerror=e,s.src=t,document.head.appendChild(s)})}async function o(){if(!navigator.userActivation||"undefined"==typeof OffscreenCanvas)return!1;try{let t=!1;const s=new Blob(['\n\tself.addEventListener("message", () =>\n\t{\n\t\ttry {\n\t\t\tconst offscreenCanvas = new OffscreenCanvas(32, 32);\n\t\t\tconst gl = offscreenCanvas.getContext("webgl");\n\t\t\tself.postMessage(!!gl);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tconsole.warn("Feature detection worker error:", err);\n\t\t\tself.postMessage(false);\n\t\t}\n\t});'],{type:"text/javascript"}),i=new Worker(URL.createObjectURL(s),{get type(){t=!0}}),e=await new Promise(t=>{i.addEventListener("message",s=>{i.terminate(),t(s.data)}),i.postMessage("")});return t&&e}catch(t){return console.warn("Error feature detecting worker mode: ",t),!1}}let r=new Audio;const a={"audio/webm; codecs=opus":!!r.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!r.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!r.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!r.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!r.canPlayType("audio/mp4"),"audio/mpeg":!!r.canPlayType("audio/mpeg")};async function c(t){const s=await l(t);return new TextDecoder("utf-8").decode(s)}function l(t){return new Promise((s,i)=>{const e=new FileReader;e.onload=t=>s(t.target.result),e.onerror=t=>i(t),e.readAsArrayBuffer(t)})}r=null;const u=[];let d=0;const w=8;window.RealFile=window.File;const f=[],p=new Map,m=new Map;let y=0;const g=[];self.runOnStartup=function(t){if("function"!=typeof t)throw new Error("runOnStartup called without a function");g.push(t)};const v=new Set(["cordova","playable-ad-single-file","playable-ad-zip","instant-games"]);function b(t){return v.has(t)}let _=!1;window.ss=class t{constructor(t){if(this.es=t.ns,this.hs=null,this.rs="",this.cs=t.ls,this.us=null,this.ds=null,this.ws=[],this.fs=null,this.ps=!0,this.ys=[],this.gs=[],this.vs=!1,this.bs=()=>this._s(),this.Ss=!1,this.ks=0,this.Os=null,this.Ps=-1,this.Ms=()=>this.Rs(),this.Cs=new Set,this.xs=null,this.Ts=[],this.Is=t.As,this.Es="file"===location.protocol.substr(0,4),this.Gs=[],"playable-ad-single-file"!==this.Is&&"playable-ad-zip"!==this.Is&&"instant-games"!==this.Is||(this.es=!1),e&&(this.es=!1),"cordova"===this.Is&&this.es&&i){const t=/Chrome\/(\d+)/i.exec(navigator.userAgent);t&&parseInt(t[1],10)>=90||(this.es=!1)}this.Fs()?self.chrome.webview.addEventListener("message",t=>this.Ls(t.data,t.additionalObjects)):"macos-wkwebview"===this.Is?self.C3WrapperOnMessage=t=>this.Ls(JSON.parse(t)):"linux-cef"===this.Is&&self.c3_linux_cef_set_message_callback(t=>this.Ls(JSON.parse(t))),this.Ds=null,this.Ws=null,"html5"!==this.Is||window.isSecureContext||console.warn("[Construct] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available."),this.I("canvas","update-size",t=>this.Us(t)),this.I("canvas","set-html-layer-count",t=>this._OnSetHTMLLayerCount(t)),this.I("canvas","cleanup-html-layers",()=>this.Hs()),this.I("canvas","update-html-layer-dom-state",t=>this.Bs(t.layersDomState)),this.I("runtime","cordova-fetch-local-file",t=>this.Vs(t)),this.I("runtime","create-job-worker",t=>this.js(t)),this.I("runtime","send-wrapper-extension-message",t=>this.Ns(t)),"cordova"===this.Is?document.addEventListener("deviceready",()=>this.$s(t)):this.$s(t),this.zs=0}et(){this.qs(),this.hs&&(this.hs.onmessage=null,this.hs=null),this.us&&(this.us.terminate(),this.us=null),this.ds&&(this.ds.et(),this.ds=null);for(const{canvas:t,Ys:s}of this.ys)t.remove(),s.remove();this.ys.length=0}Xs(){return this.ys[0].canvas}Nt(t){return Math.min(t,this.ys.length-1)}$t(t){if(t<0||t>=this.ys.length)throw new RangeError("invalid canvas layer");return this.ys[t].Ys}_GetHTMLWrapElement(t){return this.$t(t)}Js(){return this.rs}R(){return this.es}Ks(){return this.Is}Zs(){return this.Es}Qs(){return this.cs}ti(){return s&&"cordova"===this.Is}si(){const t=navigator.userAgent;return s&&b(this.Is)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(t)}ii(){return i}ei(){return i&&b(this.Is)}ni(){return"windows-webview2"===this.Is||!!("preview"===this.Is&&window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage)}Fs(){return this.ni()||"xbox-uwp-webview2"===this.Is}hi(){this.ei()&&this.zs++}oi(){return this.ri().next().value}*ri(){if(!this.ei())return!0;yield 0===this.zs,this.zs>0&&this.zs--}async $s(t){if(this.es&&(await o()||(this.es=!1)),"macos-wkwebview"===this.Is&&this.ai({type:"ready"}),this.Fs()||"macos-wkwebview"===this.Is||"linux-cef"===this.Is){this.ci();const t=await this.li();this.Ts=t.registeredComponentIds}if("playable-ad-single-file"===this.Is&&(this.Ds=self.c3_base64files,this.Ws={},await this.di()),"nwjs"===this.Is&&self.nw&&(self.nw.Window.get().on("close",()=>self.nw.App.quit()),self.nw.App.manifest["c3-steam-mode"])){let t=0;this.D(()=>{t++,document.documentElement.style.opacity=t%2==0?"1":"0.999"})}if(t.wi)this.rs=t.wi;else{const t=location.origin;this.rs=("null"===t?"file:///":t)+location.pathname;const s=this.rs.lastIndexOf("/");-1!==s&&(this.rs=this.rs.substr(0,s+1))}const s=new MessageChannel;if(this.hs=s.port1,this.hs.onmessage=t=>this._OnMessageFromRuntime(t.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(t=>this.fi(t)),this.Os=new self.pi(this),await this.Os.mi(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen)try{await new Promise((t,s)=>{window.AndroidFullScreen.immersiveMode(t,s)})}catch(t){console.error("Failed to enter Android immersive mode: ",t)}this.es?await this.yi(t,s.port2):await this.gi(t,s.port2)}bi(s){return{runtimeBaseUrl:this.rs,previewUrl:location.href,windowInnerWidth:this._i(),windowInnerHeight:this.Si(),cssDisplayMode:this.ki(),devicePixelRatio:window.devicePixelRatio,isFullscreen:t.Oi(),swClientId:window.cr_swClientId||"",exportType:s.As,isNWjs:"undefined"!=typeof nw,fileMap:globalThis.Pi??new Map(Object.entries(this.Ds??{})),scriptFolder:this.cs,isDebug:new URLSearchParams(self.location.search).has("debug"),ife:!!self.Mi,jobScheduler:this.Os.Ri(),supportedAudioFormats:a,isFileProtocol:this.Es,isiOSCordova:this.ti(),isiOSWebView:this.si(),isWindowsWebView2:this.ni(),isAnyWebView2Wrapper:this.Fs(),wrapperComponentIds:this.Ts,isFBInstantAvailable:void 0!==self.FBInstant}}async yi(t,s){const i=t.Ci;"preview"===this.Is?(this.us=new Worker("previewworker.js",{type:"module",name:"Runtime"}),await new Promise((t,s)=>{const e=i=>{this.us.removeEventListener("message",e),i.data&&"ok"===i.data.type?t():s()};this.us.addEventListener("message",e),this.us.postMessage({type:"construct-worker-init",import:new URL(i,this.rs).toString()})})):this.us=await this.xi(i,{type:"module",name:"Runtime"});const e=document.createElement("canvas");e.style.display="none";const n=e.transferControlToOffscreen();document.body.appendChild(e);const h=document.createElement("div");h.className="c3htmlwrap",h.setAttribute("interactive",""),document.body.appendChild(h),this.ys.push({canvas:e,Ys:h,Ti:{isVisible:!0,opacity:1,Ii:!0}}),window.c3canvas=e,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.us.postMessage(Object.assign(this.bi(t),{type:"init-runtime",isInWorker:!0,messagePort:s,canvas:n,runtimeScriptList:t.Ai,projectMainScriptPath:t.Ei,javaScriptInEventsPath:t.Gi,typeScriptInEventsPath:t.Fi}),[s,n,...this.Os.Li()]),this.ws=f.map(t=>new t(this)),this.Di(),this.fs.Wi(e),this.fs.Ui(h),this.fs.Hi(),self.c3_callFunction=(t,s)=>this.fs.Bi(t,s),"preview"===this.Is&&(self.goToLastErrorScript=()=>this.S("runtime","go-to-last-error-script"))}async gi(t,s){const i=document.createElement("canvas");i.style.display="none",document.body.appendChild(i);const e=document.createElement("div");e.className="c3htmlwrap",e.setAttribute("interactive",""),document.body.appendChild(e),this.ys.push({canvas:i,Ys:e,Ti:{isVisible:!0,opacity:1,Ii:!0}}),window.c3canvas=i,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.ws=f.map(t=>new t(this)),this.Di(),this.fs.Wi(i),this.fs.Ui(e);const n=await Promise.all(t.Ai.map(t=>this.Vi(t)));await Promise.all(n.map(t=>h(t)));const o=t.Ei,r=t.Gi,a=t.Fi;if(o)try{if(await h(o),"preview"===this.Is&&!globalThis.ji)throw new Error("main script did not run to completion")}catch(t){this.Ni(),console.error("Error loading project main script: ",t),alert(`Failed to load the project main script (${o}). Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the script. Press F12 and check the console for error details.`)}if(r)try{if(await h(r),"preview"===this.Is&&!globalThis.zi.$i)throw new Error("JavaScript in events did not run to completion")}catch(t){this.Ni(),console.error("Error loading JavaScript in events: ",t),alert("Failed to load JavaScript in events. Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the 'Imports for events' script. Press F12 and check the console for error details.")}if(a)try{if(await h(a),"preview"===this.Is&&!globalThis.zi.Yi)throw new Error("TypeScript in events did not run to completion")}catch(t){this.Ni(),console.error("Error loading TypeScript in events: ",t),alert("Failed to load TypeScript in events. Check all your TypeScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the 'Imports for events' script. Press F12 and check the console for error details.")}const c=Object.assign(this.bi(t),{isInWorker:!1,messagePort:s,canvas:i,runOnStartupFunctions:g});this.fs.Hi(),this.Xi(),this.ds=self.C3_CreateRuntime(c),await self.C3_InitRuntime(this.ds,c)}async xi(t,s){if(t.startsWith("blob:"))return new Worker(t,s);if("cordova"===this.Is&&this.Es){const i=await this.Ji(t),e=new Blob([i],{type:"application/javascript"});return new Worker(URL.createObjectURL(e),s)}if("playable-ad-single-file"===this.Is){const i=this.Ds[t];if(!i)throw new Error("missing script: "+t);return new Worker(URL.createObjectURL(i),s)}const i=new URL(t,location.href);if(location.origin!==i.origin){const t=await fetch(i);if(!t.ok)throw new Error("failed to fetch worker script");const e=await t.blob();return new Worker(URL.createObjectURL(e),s)}return new Worker(i,s)}_i(){return Math.max(window.innerWidth,1)}Si(){return Math.max(window.innerHeight,1)}ki(){if(this.Fs())return"standalone";const t=this.Ks();return new Set(["cordova","nwjs","macos-wkwebview","linux-cef"]).has(t)?"standalone":window.matchMedia("(display-mode: fullscreen)").matches?"fullscreen":window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: minimal-ui)").matches?"minimal-ui":navigator.standalone?"standalone":"browser"}Xi(){this.Ni()}Ni(){const t=window.cr_previewLoadingElem;t&&(t.parentElement.removeChild(t),window.cr_previewLoadingElem=null)}async js(t){const s=await this.Os.Ki();return{outputPort:s,transferables:[s]}}Us(t){if(this.Zi())return;const s=t.styleWidth+"px",i=t.styleHeight+"px",e=t.marginLeft+"px",n=t.marginTop+"px";for(const{canvas:t,Ys:h}of this.ys)t.style.width=s,t.style.height=i,t.style.marginLeft=e,t.style.marginTop=n,h.style.width=s,h.style.height=i,h.style.marginLeft=e,h.style.marginTop=n,this.ps&&(t.style.display="",h.style.display="");document.documentElement.style.setProperty("--construct-scale",t.displayScale),this.ps=!1}_OnSetHTMLLayerCount(t){const s=t.count,i=t.layersDomState,e=t.immediate,n=t.styleWidth+"px",h=t.styleHeight+"px",o=t.marginLeft+"px",r=t.marginTop+"px",a=[],c=[];if(s<this.ys.length)for(;this.ys.length>s;){const{canvas:t,Ys:s}=this.ys.pop();s.remove(),this.es&&!e?this.gs.push(t):t.remove()}else if(s>this.ys.length)for(let t=0,i=s-this.ys.length;t<i;++t){const t=document.createElement("canvas");if(t.classList.add("c3overlay"),this.es){const s=t.transferControlToOffscreen();a.push(s),c.push(s)}else a.push(t);document.body.appendChild(t);const s=document.createElement("div");s.classList.add("c3htmlwrap","c3overlay"),s.setAttribute("interactive",""),document.body.appendChild(s),t.style.width=n,t.style.height=h,t.style.marginLeft=o,t.style.marginTop=r,s.style.width=n,s.style.height=h,s.style.marginLeft=o,s.style.marginTop=r,this.fs.Wi(t),this.fs.Ui(s),this.ys.push({canvas:t,Ys:s,Ti:{isVisible:!0,opacity:1,Ii:!0}})}this.Bs(i);for(const t of this.ws)t instanceof window.Ot&&t.Jt();return this.Xt(),{addedCanvases:a,transferables:c}}Bs(t){for(let s=0,i=Math.min(this.ys.length,t.length);s<i;++s){const{Ys:i,Ti:e}=this.ys[s],n=t[s],h=n.isVisible,o=n.opacity,r=n.isInteractive;h!==e.isVisible&&(i.style.display=h?"":"none",e.isVisible=h),o!==e.opacity&&(i.style.opacity=1===o?"":String(o),e.opacity=o),r!==e.Ii&&(i.style.pointerEvents=r?"":"none",r?i.setAttribute("interactive",""):i.removeAttribute("interactive"),e.Ii=r)}}Hs(){for(const t of this.gs)t.remove();this.gs.length=0}Xt(){this.vs||(this.vs=!0,this.D(this.bs))}_s(){this.U(this.bs),this.vs=!1;let t=[];for(const s of this.ws)if(s instanceof window.Ot){const i=s.Kt();i&&t.push(...i)}t.sort((t,s)=>{const i=t.vt(),e=s.vt();return i!==e?i-e:t.St()-s.St()});let s=0,i=0,e=0,n=t.length;for(;e<n;++e){const n=t[e];n.vt()!==s&&(this.Qi(s,t.slice(i,e)),s=n.vt(),i=e)}i<e&&this.Qi(s,t.slice(i,e))}Qi(t,s){if(s.length<=1)return;if(t>=this.ys.length)return;const i=s.map(t=>t.kt()),e=new Set(i),n=this.$t(t),h=Array.from(n.children).filter(t=>e.has(t));for(let t=0,s=0,e=i.length;t<e;++t){const e=i[t],o=h[s];e===o?++s:n.moveBefore?n.moveBefore(e,o):n.insertBefore(e,o)}}C(){if(this.es)throw new Error("not available in worker mode");return this.ds}S(t,s,i,e,n){this.hs.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:null},n)}P(t,s,i,e,n){const h=y++,o=new Promise((t,s)=>{m.set(h,{resolve:t,reject:s})});return this.hs.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:h},n),o}_OnMessageFromRuntime(t){const s=t.type;if("event"===s)return this.te(t);if("result"===s)this.se(t);else if("runtime-ready"===s)this.ie();else if("alert-error"===s)this.Ni(),alert(t.message);else{if("creating-runtime"!==s)throw new Error(`unknown message '${s}'`);this.Xi()}}te(t){const s=t.component,i=t.handler,e=t.data,n=t.responseId,h=p.get(s);if(!h)return void console.warn(`[DOM] No event handlers for component '${s}'`);const o=h.get(i);if(!o)return void console.warn(`[DOM] No handler '${i}' for component '${s}'`);let r=null;try{r=o(e)}catch(t){return console.error(`Exception in '${s}' handler '${i}':`,t),void(null!==n&&this.ee(n,!1,""+t))}if(null===n)return r;r&&r.then?r.then(t=>this.ee(n,!0,t)).catch(t=>{console.error(`Rejection from '${s}' handler '${i}':`,t),this.ee(n,!1,""+t)}):this.ee(n,!0,r)}ee(t,s,i){let e;i&&i.transferables&&(e=i.transferables),this.hs.postMessage({type:"result",responseId:t,isOk:s,result:i},e)}se(t){const s=t.responseId,i=t.isOk,e=t.result,n=m.get(s);i?n.resolve(e):n.reject(e),m.delete(s)}I(t,s,i){let e=p.get(t);if(e||(e=new Map,p.set(t,e)),e.has(s))throw new Error(`[DOM] Component '${t}' already has handler '${s}'`);e.set(s,i)}static ne(t){if(f.includes(t))throw new Error("DOM handler already added");f.push(t)}Di(){for(const t of this.ws)if("runtime"===t.F())return void(this.fs=t);throw new Error("cannot find runtime DOM handler")}fi(t){this.S("debugger","message",t)}ie(){for(const t of this.ws)t.v()}static Oi(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||_)}static he(t){_=!!t}async oe(){return await this.P("runtime","get-remote-preview-status-info")}D(t){this.Cs.add(t),this.re()}U(t){this.Cs.delete(t),0===this.Cs.size&&this.qs()}re(){-1===this.Ps&&this.Cs.size>0&&(this.Ps=requestAnimationFrame(this.Ms))}qs(){-1!==this.Ps&&(cancelAnimationFrame(this.Ps),this.Ps=-1)}Rs(){this.Ps=-1;for(const t of this.Cs)t();this.re()}ae(t){this.fs.ae(t)}ce(t){this.fs.ce(t)}le(){this.fs.le()}ue(t){this.fs.ue(t)}de(t){return!!a[t]}we(t){this.Ss=!0,this.ks=t}Zi(){return this.Ss}fe(){return this.ks}pe(t){return/^(?:[a-z\-]+:)?\/\//.test(t)||"data:"===t.substr(0,5)||"blob:"===t.substr(0,5)}me(t){return!this.pe(t)}async Vi(t){if("cordova"===this.Is&&(t.startsWith("file:")||this.Es&&this.me(t))){let s=t;s.startsWith(this.rs)&&(s=s.substr(this.rs.length));const i=await this.Ji(s),e=new Blob([i],{type:"application/javascript"});return URL.createObjectURL(e)}if("playable-ad-single-file"===this.Is){if(this.Ws.hasOwnProperty(t))return{Qt:!0,ts:this.Ws[t]};if(this.Ds.hasOwnProperty(t))return URL.createObjectURL(this.Ds[t]);throw new Error("missing script: "+t)}return t}async Vs(t){const s=t.filename;switch(t.as){case"text":return await this.ye(s);case"buffer":return await this.Ji(s);default:throw new Error("unsupported type")}}ge(t){const s=window.cordova.file.applicationDirectory+"www/"+t;return new Promise((t,i)=>{window.resolveLocalFileSystemURL(s,s=>{s.file(t,i)},i)})}async ye(t){const s=await this.ge(t);return await c(s)}ve(){if(!u.length)return;if(d>=w)return;d++;const t=u.shift();this.be(t.filename,t._e,t.Se)}Ji(t){return new Promise((s,i)=>{u.push({filename:t,_e:t=>{d--,this.ve(),s(t)},Se:t=>{d--,this.ve(),i(t)}}),this.ve()})}async be(t,s,i){try{const i=await this.ge(t);s(await l(i))}catch(t){i(t)}}_PlayableAdFetchBlob(t){if(this.Ds.hasOwnProperty(t))return this.Ds[t];throw new Error("missing file: "+t)}ke(){const t=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof t)throw new Error("Permission API is not loaded");return t}Oe(t,s){const i=t[s];if("string"!=typeof i)throw new Error("Invalid permission name");return i}Pe(t){const s=this.ke();return new Promise((i,e)=>s.checkPermission(this.Oe(s,t),t=>i(!!t.hasPermission),e))}Me(t){const s=this.ke();return new Promise((i,e)=>s.requestPermission(this.Oe(s,t),t=>i(!!t.hasPermission),e))}async Re(t){if("cordova"!==this.Ks())return!0;if(this.ti())return!0;for(const s of t)if(!await this.Pe(s)&&!1===await this.Me(s))return!1;return!0}async Ce(...t){if(!1===await this.Re(t))throw new Error("Permission not granted")}Ls(s,i){if("object"!=typeof s||!s)return void console.warn("Unknown wrapper message: ",s);const e=s.type;if("directory-handles"===e)this.Gs=i;else if("wrapper-init-response"===e)this.xs(s),this.xs=null;else if("fullscreen-change"===e)t.he(s.isFullscreen),this.fs.xe();else if("log-to-console"===e)switch(s.logType){case"error":console.error(s.message);break;case"warning":console.warn(s.message);break;default:console.log(s.message)}else"extension-message"===e?this.S("runtime","wrapper-extension-message",s):console.warn("Unknown wrapper message: ",s)}Ns(t){this.ai({type:"extension-message",componentId:t.componentId,messageId:t.messageId,params:t.params||[],asyncId:t.asyncId})}ai(t){this.Fs()?window.chrome.webview.postMessage(JSON.stringify(t)):"macos-wkwebview"===this.Is?window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(t)):"linux-cef"===this.Is&&window.c3_linux_cef_sendmessage(JSON.stringify(t))}ci(){window.moveTo=(t,s)=>{this.ai({type:"set-window-position",windowX:Math.ceil(t),windowY:Math.ceil(s)})},window.resizeTo=(t,s)=>{this.ai({type:"set-window-size",windowWidth:Math.ceil(t),windowHeight:Math.ceil(s)})}}li(){return new Promise(t=>{this.xs=t,this.ai({type:"wrapper-init"})})}Te(){return this.Gs}async di(){const t=[];for(const[s,i]of Object.entries(this.Ds))t.push(this.Ie(s,i));await Promise.all(t)}async Ie(t,s){if("object"==typeof s)this.Ds[t]=new Blob([s.str],{type:s.type}),this.Ws[t]=s.str;else{let i=await this.Ae(s);i||(i=this.Ee(s)),this.Ds[t]=i}}async Ae(t){try{const s=await fetch(t);return await s.blob()}catch(t){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",t),null}}Ee(t){const s=this.Ge(t);return this.Fe(s.data,s.Le)}Ge(t){const s=t.indexOf(",");if(s<0)throw new URIError("expected comma in data: uri");const i=t.substring(5,s),e=t.substring(s+1),n=i.split(";"),h=n[0]||"",o=n[1],r=n[2];let a;return a="base64"===o||"base64"===r?atob(e):decodeURIComponent(e),{Le:h,data:a}}Fe(t,s){let i,e,n=t.length,h=n>>2,o=new Uint8Array(n),r=new Uint32Array(o.buffer,0,h);for(i=0,e=0;i<h;++i)r[i]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;let a=3&n;for(;a--;)o[e]=t.charCodeAt(e),++e;return new Blob([o],{type:s})}}}{const S=self.ss;function k(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||t.originalEvent&&t.originalEvent.sourceCapabilities&&t.originalEvent.sourceCapabilities.firesTouchEvents}const O=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),P={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},M={dispatchUserScriptEvent:!0},R={dispatchRuntimeEvent:!0};async function C(t){const s=URL.createObjectURL(t);try{return await(i=s,new Promise((t,s)=>{const e=new Image;e.onload=()=>t(e),e.onerror=t=>s(t),e.src=i}))}finally{URL.revokeObjectURL(s)}var i}function x(t){do{if(t.parentNode&&t.hasAttribute("contenteditable"))return!0;t=t.parentNode}while(t);return!1}const T=new Set(["input","textarea","datalist","select"]),I=new Set(["canvas","body","html"]);function A(t){if(!t.target.tagName)return;const s=t.target.tagName.toLowerCase();I.has(s)&&t.preventDefault()}function E(t){t.target.tagName&&t.target.classList.contains("c3htmlwrap")&&t.preventDefault()}function G(t){(t.metaKey||t.ctrlKey)&&t.preventDefault()}self.C3_GetSvgImageSize=async function(t){const s=await C(t);if(s.width>0&&s.height>0)return[s.width,s.height];{s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.visibility="hidden",document.body.appendChild(s);const t=s.getBoundingClientRect();return document.body.removeChild(s),[t.width,t.height]}},self.C3_RasterSvgImageBlob=async function(t,s,i,e,n){const h=await C(t),o=document.createElement("canvas");return o.width=e,o.height=n,o.getContext("2d").drawImage(h,0,0,s,i),o};let F=!1;function L(){try{return window.parent&&window.parent.document.hasFocus()}catch(t){return!1}}document.addEventListener("pause",()=>F=!0),document.addEventListener("resume",()=>F=!1);const D="runtime",W=class extends self.i{constructor(t){super(t,D),this.De=!1,this.We=-1,this.Ue="any",this.He=!1,this.Be=!1,this.Ve=!1,this.je=document.createElement("div"),this.je.className="c3-screen-reader-text",this.je.setAttribute("aria-live","polite"),document.body.appendChild(this.je),this.Ne=null,this.$e=!1,this.ze="",this.qe=-1,this.Ye=!1,this.Xe=t._i(),this.Je=t.Si(),this.Ke=0,this.Ze=0,t.I("runtime","invoke-download",t=>this.Qe(t)),t.I("runtime","load-webfonts",t=>this.tn(t)),t.I("runtime","raster-svg-image",t=>this.sn(t)),t.I("runtime","get-svg-image-size",t=>this.en(t)),t.I("runtime","set-target-orientation",t=>this.nn(t)),t.I("runtime","register-sw",()=>this.hn()),t.I("runtime","post-to-debugger",t=>this.rn(t)),t.I("runtime","go-to-script",t=>this.rn(t)),t.I("runtime","before-start-ticking",()=>this.an()),t.I("runtime","debug-highlight",t=>this.cn(t)),t.I("runtime","enable-device-orientation",()=>this.ln()),t.I("runtime","enable-device-motion",()=>this.un()),t.I("runtime","add-stylesheet",t=>this.dn(t)),t.I("runtime","script-create-worker",t=>this.wn(t)),t.I("runtime","alert",t=>this.fn(t)),t.I("runtime","screen-reader-text",t=>this.pn(t)),t.I("runtime","hide-cordova-splash",()=>this.mn()),t.I("runtime","set-exporting-to-video",t=>this.yn(t)),t.I("runtime","export-to-video-progress",t=>this.gn(t)),t.I("runtime","exported-to-video",t=>this.vn(t)),t.I("runtime","exported-to-image-sequence",t=>this.bn(t));const s=new Set(["input","textarea","datalist"]);if(window.addEventListener("contextmenu",t=>{const i=t.target,e=i.tagName.toLowerCase();s.has(e)||x(i)||t.preventDefault()}),window.addEventListener("selectstart",A),window.addEventListener("gesturehold",A),window.addEventListener("touchstart",A,{passive:!1}),window.addEventListener("pointerdown",A,{passive:!1}),this._n=0,window.addEventListener("mousedown",t=>{1===t.button&&t.preventDefault()}),window.addEventListener("mousewheel",G,{passive:!1}),window.addEventListener("wheel",G,{passive:!1}),window.addEventListener("resize",()=>this.Sn()),window.addEventListener("fullscreenchange",()=>this.xe()),window.addEventListener("webkitfullscreenchange",()=>this.xe()),window.addEventListener("mozfullscreenchange",()=>this.xe()),window.addEventListener("fullscreenerror",t=>this.kn(t)),window.addEventListener("webkitfullscreenerror",t=>this.kn(t)),window.addEventListener("mozfullscreenerror",t=>this.kn(t)),t.si()){let t=1/0;window.visualViewport.addEventListener("resize",()=>{const s=window.visualViewport.height;s>t&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0),t=s}),document.documentElement.setAttribute("ioswebview","")}this.On=new Set,this.Pn=new WeakSet,this.Mn=!1}Wi(t){t.addEventListener("selectstart",A),t.addEventListener("gesturehold",A),t.addEventListener("pointerdown",A)}Ui(t){t.addEventListener("selectstart",E),t.addEventListener("gesturehold",E),t.addEventListener("touchstart",E)}an(){return self.setTimeout(()=>{this.Ye=!0},1e3),"cordova"===this.h.Ks()?(document.addEventListener("pause",()=>this.Rn(!0)),document.addEventListener("resume",()=>this.Rn(!1))):document.addEventListener("visibilitychange",()=>this.Rn("hidden"===document.visibilityState)),this.Ve=!("hidden"!==document.visibilityState&&!F),{isSuspended:this.Ve}}v(){window.addEventListener("focus",()=>this.Cn("window-focus")),window.addEventListener("blur",()=>{this.Cn("window-blur",{parentHasFocus:L()}),this._n=0}),window.addEventListener("focusin",t=>{var s;s=t.target,(T.has(s.tagName.toLowerCase())||x(s))&&this.Cn("keyboard-blur")}),window.addEventListener("keydown",t=>this.xn("keydown",t)),window.addEventListener("keyup",t=>this.xn("keyup",t)),window.addEventListener("mousedown",t=>this.Tn("mousedown",t,M)),window.addEventListener("mousemove",t=>this.Tn("mousemove",t,M)),window.addEventListener("mouseup",t=>this.Tn("mouseup",t,M)),window.addEventListener("dblclick",t=>this.Tn("dblclick",t,P)),window.addEventListener("wheel",t=>this.In("wheel",t,P)),window.addEventListener("pointerdown",t=>{this.An(t),this.En("pointerdown",t)}),this.h.R()&&void 0!==window.onpointerrawupdate&&self===self.top?window.addEventListener("pointerrawupdate",t=>this.Gn(t)):window.addEventListener("pointermove",t=>this.En("pointermove",t)),window.addEventListener("pointerup",t=>this.En("pointerup",t)),window.addEventListener("pointercancel",t=>this.En("pointercancel",t));const t=()=>this.le();window.addEventListener("pointerup",t,!0),window.addEventListener("touchend",t,!0),window.addEventListener("click",t,!0),window.addEventListener("keydown",t,!0),window.addEventListener("gamepadconnected",t,!0),this.h.ii()&&!this.h.ei()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",()=>{this.Fn(this.Si(),navigator.virtualKeyboard.boundingRect.height)})),this.h.si()&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0)}Fn(t,s){if(document.body.style.position="",document.body.style.overflow="",document.body.style.transform="",this.Ze=0,s>0){const i=document.activeElement;if(i){const e=i.getBoundingClientRect();let n=(e.top+e.bottom)/2-(t-s)/2;n>s&&(n=s),n<0&&(n=0),n>0&&(document.body.style.position="absolute",document.body.style.overflow="visible",document.body.style.transform=`translateY(${-n}px)`,this.Ze=n)}}}Cn(t,s){this._(t,s||null,R)}_i(){return this.h._i()}Si(){return this.h.Si()}Hi(){this.De=!0,this.Xe=this.h._i(),this.Je=this.h.Si()}Sn(){if(this.$e)return;if(!this.De)return;const t=this._i(),s=this.Si();if(this.h.ei())if(this.Ye){if(this.h.oi()&&this.Xe===t&&s<this.Je)return this.Ke=this.Je-s,void this.Fn(this.Je,this.Ke);this.Ke>0&&(this.Ke=0,this.Fn(s,this.Ke)),this.Xe=t,this.Je=s}else this.Xe=t,this.Je=s;this._("window-resize",{innerWidth:t,innerHeight:s,devicePixelRatio:window.devicePixelRatio,isFullscreen:S.Oi(),cssDisplayMode:this.h.ki()}),this.h.si()&&(-1!==this.We&&clearTimeout(this.We),this.Ln(t,s,0))}Dn(t,s,i){-1!==this.We&&clearTimeout(this.We),this.We=setTimeout(()=>this.Ln(t,s,i),48)}Ln(t,s,i){const e=this._i(),n=this.Si();this.We=-1,e!=t||n!=s?this._("window-resize",{innerWidth:e,innerHeight:n,devicePixelRatio:window.devicePixelRatio,isFullscreen:S.Oi(),cssDisplayMode:this.h.ki()}):i<10&&this.Dn(e,n,i+1)}nn(t){this.Ue=t.targetOrientation}Wn(){const t=this.Ue;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(t).catch(t=>console.warn("[Construct] Failed to lock orientation: ",t));else try{let s=!1;screen.lockOrientation?s=screen.lockOrientation(t):screen.webkitLockOrientation?s=screen.webkitLockOrientation(t):screen.mozLockOrientation?s=screen.mozLockOrientation(t):screen.msLockOrientation&&(s=screen.msLockOrientation(t)),s||console.warn("[Construct] Failed to lock orientation")}catch(t){console.warn("[Construct] Failed to lock orientation: ",t)}}xe(){if(this.$e)return;const t=S.Oi();t&&"any"!==this.Ue&&this.Wn(),this._("fullscreenchange",{isFullscreen:t,innerWidth:this._i(),innerHeight:this.Si()})}kn(t){console.warn("[Construct] Fullscreen request failed: ",t),this._("fullscreenerror",{isFullscreen:S.Oi(),innerWidth:this._i(),innerHeight:this.Si()})}Rn(t){if(this.Ve!==t&&(this.Ve=t,t?this.h.qs():this.h.re(),this._("visibilitychange",{hidden:t}),!t&&this.h.si())){const t=()=>{document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0};setTimeout(t,50),setTimeout(t,100),setTimeout(t,250),setTimeout(t,500)}}xn(t,s){if(void 0===s.key)return;if("Backspace"===s.key&&A(s),"nwjs"===this.h.Ks()&&"u"===s.key&&(s.ctrlKey||s.metaKey)&&s.preventDefault(),this.$e)return;const i=O.get(s.code)||s.code;this.M(t,{code:i,key:s.key,which:s.which,repeat:s.repeat,altKey:s.altKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,shiftKey:s.shiftKey,timeStamp:s.timeStamp},P)}In(t,s,i){this.$e||this._(t,{clientX:s.clientX,clientY:s.clientY+this.Ze,pageX:s.pageX,pageY:s.pageY+this.Ze,deltaX:s.deltaX,deltaY:s.deltaY,deltaZ:s.deltaZ,deltaMode:s.deltaMode,timeStamp:s.timeStamp},i)}Tn(t,s,i){this.$e||k(s)||this.M(t,{button:s.button,buttons:s.buttons,clientX:s.clientX,clientY:s.clientY+this.Ze,pageX:s.pageX,pageY:s.pageY+this.Ze,movementX:s.movementX||0,movementY:s.movementY||0,timeStamp:s.timeStamp},i)}En(t,s){if(this.$e)return;let i=0;"mouse"===s.pointerType&&(i=this._n),this.M(t,{pointerId:s.pointerId,pointerType:s.pointerType,button:s.button,buttons:s.buttons,lastButtons:i,clientX:s.clientX,clientY:s.clientY+this.Ze,pageX:s.pageX,pageY:s.pageY+this.Ze,movementX:s.movementX||0,movementY:s.movementY||0,width:s.width||0,height:s.height||0,pressure:s.pressure||0,tangentialPressure:s.tangentialPressure||0,tiltX:s.tiltX||0,tiltY:s.tiltY||0,twist:s.twist||0,timeStamp:s.timeStamp},P),"mouse"===s.pointerType&&(this._n=s.buttons)}Gn(t){this.En("pointermove",t)}Un(t,s){if(!this.$e)for(let i=0,e=s.changedTouches.length;i<e;++i){const e=s.changedTouches[i];this.M(t,{pointerId:e.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:e.clientX,clientY:e.clientY+this.Ze,pageX:e.pageX,pageY:e.pageY+this.Ze,movementX:s.movementX||0,movementY:s.movementY||0,width:2*(e.radiusX||e.webkitRadiusX||0),height:2*(e.radiusY||e.webkitRadiusY||0),pressure:e.force||e.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:e.rotationAngle||0,timeStamp:s.timeStamp},P)}}An(t){window!==window.top&&window.focus(),this.Hn(t.target)&&document.activeElement&&!this.Hn(document.activeElement)&&document.activeElement.blur()}Hn(t){return!t||t===document||t===window||t===document.body||"canvas"===t.tagName.toLowerCase()}ln(){this.He||(this.He=!0,window.addEventListener("deviceorientation",t=>this.Bn(t)),window.addEventListener("deviceorientationabsolute",t=>this.Vn(t)))}un(){this.Be||(this.Be=!0,window.addEventListener("devicemotion",t=>this.jn(t)))}Bn(t){this.$e||this._("deviceorientation",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp,webkitCompassHeading:t.webkitCompassHeading,webkitCompassAccuracy:t.webkitCompassAccuracy},P)}Vn(t){this.$e||this._("deviceorientationabsolute",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp},P)}jn(t){if(this.$e)return;let s=null;const i=t.acceleration;i&&(s={x:i.x||0,y:i.y||0,z:i.z||0});let e=null;const n=t.accelerationIncludingGravity;n&&(e={x:n.x||0,y:n.y||0,z:n.z||0});let h=null;const o=t.rotationRate;o&&(h={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this._("devicemotion",{acceleration:s,accelerationIncludingGravity:e,rotationRate:h,interval:t.interval,timeStamp:t.timeStamp},P)}Qe(t){const s=t.url,i=t.filename,e=document.createElement("a"),n=document.body;e.textContent=i,e.href=s,e.download=i,n.appendChild(e),e.click(),n.removeChild(e)}async tn(t){const s=t.webfonts;await Promise.all(s.map(async t=>{const s=new FontFace(t.name,`url('${t.url}')`);document.fonts.add(s),await s.load()}))}async sn(t){const s=t.blob,i=t.imageWidth,e=t.imageHeight,n=t.surfaceWidth,h=t.surfaceHeight,o=t.imageBitmapOpts,r=await self.C3_RasterSvgImageBlob(s,i,e,n,h);let a;return a=o?await createImageBitmap(r,o):await createImageBitmap(r),{imageBitmap:a,transferables:[a]}}async en(t){return await self.C3_GetSvgImageSize(t.blob)}async dn(t){var s;await(s=t.url,new Promise((t,i)=>{const e=document.createElement("link");e.onload=()=>t(e),e.onerror=t=>i(t),e.rel="stylesheet",e.href=s,document.head.appendChild(e)}))}le(){const t=[...this.On];if(this.On.clear(),!this.Mn)for(const s of t){const t=s.play();t&&t.catch(t=>{this.Pn.has(s)||this.On.add(s)})}}ae(t){if("function"!=typeof t.play)throw new Error("missing play function");let s;this.Pn.delete(t);try{s=t.play()}catch(s){return void this.On.add(t)}s&&s.catch(s=>{this.Pn.has(t)||this.On.add(t)})}ce(t){this.On.delete(t),this.Pn.add(t)}ue(t){this.Mn=!!t}mn(){navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()}cn(t){if(!t.show)return void(this.Ne&&(this.Ne.style.display="none"));this.Ne||(this.Ne=document.createElement("div"),this.Ne.id="inspectOutline",document.body.appendChild(this.Ne));const s=this.Ne;s.style.display="",s.style.left=t.left-1+"px",s.style.top=t.top-1+"px",s.style.width=t.width+2+"px",s.style.height=t.height+2+"px",s.textContent=t.name}hn(){window.C3_RegisterSW&&window.C3_RegisterSW()}rn(t){window.c3_postToMessagePort&&(t.from="runtime",window.c3_postToMessagePort(t))}Bi(t,s){return this.O("js-invoke-function",{name:t,params:s})}wn(t){const s=t.url,i=t.opts,e=t.port2;new Worker(s,i).postMessage({type:"construct-worker-init",port2:e},[e])}fn(t){alert(t.message)}pn(t){const s=t.type;if("create"===s){const s=document.createElement("p");s.id="c3-sr-"+t.id,s.textContent=t.text,this.je.appendChild(s)}else if("update"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.textContent=t.text:console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else if("release"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.remove():console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else console.warn(`[Construct] Unknown screen reader text update '${s}'`)}yn(t){this.$e=!0;const s=document.createElement("h1");s.id="exportToVideoMessage",s.textContent=t.message,document.body.prepend(s),document.body.classList.add("exportingToVideo"),this.G().Xs().style.display="",this.h.we(t.duration)}gn(t){this.ze=t.message,-1===this.qe&&(this.qe=setTimeout(()=>this.Nn(),250))}Nn(){this.qe=-1;const t=document.getElementById("exportToVideoMessage");t&&(t.textContent=this.ze)}vn(t){window.$n({type:"exported-video",arrayBuffer:t.arrayBuffer,contentType:t.contentType,time:t.time})}bn(t){window.$n({type:"exported-image-sequence",blobArr:t.blobArr,time:t.time,gif:t.gif})}};S.ne(W)}{const U="dispatchworker.js",H="jobworker.js";self.pi=class{constructor(t){this.zn=t,this.qn=Math.min(navigator.hardwareConcurrency||2,16),this.Yn=null,this.Xn=[],this.Jn=null,this.Kn=null}async mi(){if(this.Zn)throw new Error("already initialised");this.Zn=!0;const t=this.zn.Qs()+U;this.Yn=await this.zn.xi(t,{name:"DispatchWorker"});const s=new MessageChannel;this.Jn=s.port1,this.Yn.postMessage({type:"_init","in-port":s.port2},[s.port2]),this.Kn=await this.Ki()}async Ki(){const t=this.Xn.length,s=this.zn.Qs()+H,i=await this.zn.xi(s,{name:"JobWorker"+t}),e=new MessageChannel,n=new MessageChannel;return this.Yn.postMessage({type:"_addJobWorker",port:e.port1},[e.port1]),i.postMessage({type:"init",number:t,"dispatch-port":e.port2,"output-port":n.port2},[e.port2,n.port2]),this.Xn.push(i),n.port1}Ri(){return{inputPort:this.Jn,outputPort:this.Kn,maxNumWorkers:this.qn}}Li(){return[this.Jn,this.Kn]}}}{const B="mouse",V=class extends self.i{constructor(t){super(t,B),this.A([["cursor",t=>this.Qn(t)],["request-pointer-lock",t=>this.th(t)],["release-pointer-lock",()=>this.sh()]]),document.addEventListener("pointerlockchange",t=>this.ih()),document.addEventListener("pointerlockerror",t=>this.eh())}Qn(t){document.documentElement.style.cursor=t}th(t){this.h.Xs().requestPointerLock(t)}sh(){document.exitPointerLock()}ih(){this._("pointer-lock-change",{"has-pointer-lock":!!document.pointerLockElement})}eh(){this._("pointer-lock-error",{"has-pointer-lock":!!document.pointerLockElement})}};self.ss.ne(V)}{const j="keyboard",N=class extends self.i{constructor(t){super(t,j),this.nh=!(!navigator.keyboard||!navigator.keyboard.lock),this.A([["init",()=>this.hh()],["lock-keyboard",t=>this.oh(t)],["unlock-keyboard",()=>this.rh()]])}hh(){return{isKeyboardLockSupported:this.nh}}async oh(t){const s=t.keysArr;try{return 0===s.length?await navigator.keyboard.lock():await navigator.keyboard.lock(s),{isOk:!0}}catch(t){return console.error("Error locking keyboard:",t),{isOk:!1}}}rh(){try{navigator.keyboard.unlock()}catch(t){console.error("Error unlocking keyboard:",t)}}};self.ss.ne(N)}{let $=null,z=null;function q(t,s){if(t){if(s)return Array.from(document.querySelectorAll(t));{const s=document.querySelector(t);return s?[s]:[]}}return[document.documentElement]}function Y(){}window.addEventListener("beforeinstallprompt",t=>(t.preventDefault(),$=t,z&&z.ah(),!1));const X="browser",J=class extends self.i{constructor(t){super(t,X),this.Is="",this.A([["get-initial-state",t=>this.uh(t)],["ready-for-sw-messages",()=>this.dh()],["alert",t=>this.fn(t)],["close",()=>this.wh()],["set-focus",t=>this.At(t)],["vibrate",t=>this.fh(t)],["lock-orientation",t=>this.ph(t)],["unlock-orientation",()=>this.mh()],["navigate",t=>this.yh(t)],["request-fullscreen",t=>this.gh(t)],["exit-fullscreen",()=>this.bh()],["set-hash",t=>this._h(t)],["set-document-css-style",t=>this.Sh(t)],["get-document-css-style",t=>this.kh(t)],["set-window-size",t=>this.Oh(t)],["set-window-position",t=>this.Ph(t)],["request-install",()=>this.Mh()],["set-warn-on-close",t=>this.Rh(t)]]),window.addEventListener("online",()=>this.Ch(!0)),window.addEventListener("offline",()=>this.Ch(!1)),window.addEventListener("hashchange",()=>this.xh()),this.Th=t=>t.preventDefault(),document.addEventListener("backbutton",()=>this.Ih())}v(){$?this.ah():z=this,window.addEventListener("appinstalled",()=>this.Ah())}uh(t){return this.Is=t.exportType,{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isConstructArcade:void 0!==window.is_scirra_arcade,windowHasFocus:document.hasFocus()}}dh(){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(t=>this._("sw-message",t.data))}ah(){this._("install-available")}async Mh(){if(!$)return{result:"unavailable"};try{return $.prompt(),{result:(await $.userChoice).outcome}}catch(t){return console.error("[Construct] Requesting install failed: ",t),{result:"failed"}}}Ah(){this._("app-installed")}Ch(t){this._("online-state",{isOnline:t})}Ih(){this._("backbutton")}Eh(){return"nwjs"===this.Is?nw.Window.get():null}fn(t){alert(t.message)}wh(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():self.nw?self.nw.App.quit():window.close()}At(t){const s=t.isFocus;if("nwjs"===this.Is){const t=this.Eh();s?t.focus():t.blur()}else s?window.focus():window.blur()}fh(t){navigator.vibrate&&navigator.vibrate(t.pattern)}ph(t){const s=t.orientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(s).catch(t=>console.warn("[Construct] Failed to lock orientation: ",t));else try{let t=!1;screen.lockOrientation?t=screen.lockOrientation(s):screen.webkitLockOrientation?t=screen.webkitLockOrientation(s):screen.mozLockOrientation?t=screen.mozLockOrientation(s):screen.msLockOrientation&&(t=screen.msLockOrientation(s)),t||console.warn("[Construct] Failed to lock orientation")}catch(t){console.warn("[Construct] Failed to lock orientation: ",t)}}mh(){try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(t){}}yh(t){const s=t.type;if("back"===s)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.history.back();else if("forward"===s)window.history.forward();else if("reload"===s)location.reload();else if("url"===s){const s=t.url,i=t.target,e=t.exportType;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(s,"_system"):"preview"===e||"macos-wkwebiew"===e||"linux-cef"===e||this.h.Fs()?window.open(s,"_blank"):this.Gh||(2===i?window.top.location=s:1===i?window.parent.location=s:window.location=s)}else if("new-window"===s){const s=t.url,i=t.tag;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(s,"_system"):window.open(s,i)}}gh(t){if(this.h.Fs()||"macos-wkwebview"===this.Is||"linux-cef"===this.Is)self.ss.he(!0),this.h.ai({type:"set-fullscreen",fullscreen:!0});else{const s={navigationUI:"auto"},i=t.navUI;1===i?s.navigationUI="hide":2===i&&(s.navigationUI="show");const e=document.documentElement;let n;e.requestFullscreen?n=e.requestFullscreen(s):e.mozRequestFullScreen?n=e.mozRequestFullScreen(s):e.msRequestFullscreen?n=e.msRequestFullscreen(s):e.webkitRequestFullScreen&&(n=void 0!==Element.ALLOW_KEYBOARD_INPUT?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen()),n instanceof Promise&&n.catch(Y)}}bh(){if(this.h.Fs()||"macos-wkwebview"===this.Is||"linux-cef"===this.Is)self.ss.he(!1),this.h.ai({type:"set-fullscreen",fullscreen:!1});else{let t;document.exitFullscreen?t=document.exitFullscreen():document.mozCancelFullScreen?t=document.mozCancelFullScreen():document.msExitFullscreen?t=document.msExitFullscreen():document.webkitCancelFullScreen&&(t=document.webkitCancelFullScreen()),t instanceof Promise&&t.catch(Y)}}_h(t){location.hash=t.hash}xh(){this._("hashchange",{location:location.toString()})}Sh(t){const s=t.prop,i=t.value,e=t.selector,n=t["is-all"];try{const t=q(e,n);for(const e of t)s.startsWith("--")?e.style.setProperty(s,i):e.style[s]=i}catch(t){console.warn("[Browser] Failed to set style: ",t)}}kh(t){const s=t.prop,i=t.selector;try{const t=document.querySelector(i);return t?{isOk:!0,result:window.getComputedStyle(t).getPropertyValue(s)}:{isOk:!1}}catch(t){return console.warn("[Browser] Failed to get style: ",t),{isOk:!1}}}Oh(t){window.resizeTo(t.windowWidth,t.windowHeight)}Ph(t){window.moveTo(t.windowX,t.windowY)}Rh(t){t.enabled?window.addEventListener("beforeunload",this.Th):window.removeEventListener("beforeunload",this.Th)}};self.ss.ne(J)}{const K=180/Math.PI,Z="audio";self.Fh=class extends self.i{constructor(t){super(t,Z),this.Lh=null,this.Dh=null,this.Wh=!1,this.Uh=()=>this.Hh(),this.Bh=[],this.Vh=[],this.jh=null,this.Nh=[],this.$h=new Set,this.zh=-1,this.qh=new Map,this.Yh=1,this.Mn=!1,this.Xh=0,this.Jh=1,this.Kh=0,this.Zh="HRTF",this.Qh="inverse",this.so=600,this.io=1e4,this.eo=1,this.no=[0,0,0],this.ho=[0,0,-1,0,1,0],this.oo=!1,this.ro=null,this.ao=new Map,this.co=new Set,this.lo=!1,this.uo=!1,this.do="",this.wo=null,self.C3Audio_OnMicrophoneStream=(t,s)=>this.fo(t,s),this.po=null,self.C3Audio_GetOutputStream=()=>this.mo(),self.C3Audio_DOMInterface=this,this.A([["create-audio-context",t=>this.yo(t)],["play",t=>this.vo(t)],["stop",t=>this.bo(t)],["stop-all",()=>this._o()],["set-paused",t=>this.So(t)],["set-volume",t=>this.ko(t)],["fade-volume",t=>this.Oo(t)],["set-master-volume",t=>this.Po(t)],["set-muted",t=>this.Mo(t)],["set-silent",t=>this.Ro(t)],["set-looping",t=>this.Co(t)],["set-playback-rate",t=>this.xo(t)],["set-stereo-pan",t=>this.To(t)],["seek",t=>this.Io(t)],["preload",t=>this.Ao(t)],["unload",t=>this.Eo(t)],["unload-all",()=>this.Go()],["set-suspended",t=>this.Fo(t)],["add-effect",t=>this.Lo(t)],["set-effect-param",t=>this.Do(t)],["remove-effects",t=>this.Wo(t)],["tick",t=>this.Uo(t)],["load-state",t=>this.Ho(t)],["offline-render-audio",t=>this.Bo(t)],["offline-render-finish",()=>this.Vo()]])}async yo(t){if(t.usePlayMusicAsSoundWorkaround&&(this.oo=!0),this.Xh=t.timeScaleMode,this.Zh=["equalpower","HRTF","soundfield"][t.panningModel],this.Qh=["linear","inverse","exponential"][t.distanceModel],this.so=t.refDistance,this.io=t.maxDistance,this.eo=t.rolloffFactor,this.h.Zi()){this.oo=!0;const t=48e3;this.Lh=new OfflineAudioContext({numberOfChannels:2,sampleRate:t,length:Math.ceil(this.h.fe()*t)})}else this.Lh=new AudioContext({latencyHint:t.latencyHint}),"running"!==this.Lh.state&&this.jo(),this.Lh.onstatechange=()=>{"running"===this.Lh.state?this.No():this.jo(),this._("audiocontext-state",{audioContextState:this.Lh.state})};this.Dh=this.Lh.createGain(),this.Dh.connect(this.Lh.destination);const s=t.listenerPos;this.no[0]=s[0],this.no[1]=s[1],this.no[2]=s[2],this.Lh.listener.setPosition(s[0],s[1],s[2]),this.Lh.listener.setOrientation(...this.ho),self.C3_GetAudioContextCurrentTime=()=>this.$o();try{await Promise.all(t.preloadList.map(t=>this.zo(t.originalUrl,t.url,t.type,!1)))}catch(t){console.error("[Construct] Preloading sounds failed: ",t)}return{sampleRate:this.Lh.sampleRate,audioContextState:this.Lh.state,outputLatency:this.Lh.outputLatency||0}}jo(){this.Wh||(window.addEventListener("pointerup",this.Uh,!0),window.addEventListener("touchend",this.Uh,!0),window.addEventListener("click",this.Uh,!0),window.addEventListener("keydown",this.Uh,!0),this.h.si()||document.addEventListener("visibilitychange",this.Uh),this.Wh=!0)}No(){this.Wh&&(window.removeEventListener("pointerup",this.Uh,!0),window.removeEventListener("touchend",this.Uh,!0),window.removeEventListener("click",this.Uh,!0),window.removeEventListener("keydown",this.Uh,!0),this.h.si()||document.removeEventListener("visibilitychange",this.Uh),this.Wh=!1)}Hh(){"running"!==this.Lh.state&&this.Lh.resume()}qo(t,s){for(const i of s){let s=!1;for(const e of t)if(self.Fh.Yo(e,i)){s=!0;break}if(!s)return!1}return!0}Xo(){return this.Lh}$o(){return this.Lh.currentTime}Jo(){return this.Dh}GetAudioContextExtern(){return this.Xo()}GetDestinationNodeExtern(){return this.Jo()}Ko(t){const s=this.ao.get(t.toLowerCase());return s?s[0].Zo():this.Jo()}Qo(t,s){t=t.toLowerCase();let i=this.ao.get(t);i||(i=[],this.ao.set(t,i)),s.tr(i.length),s.sr(t),i.push(s),this.ir(t)}ir(t){t=t.toLowerCase();let s=this.Jo();const i=this.ao.get(t);if(i&&i.length){s=i[0].Zo();for(let t=0,s=i.length;t<s;++t){const e=i[t];t+1===s?e.er(this.Jo()):e.er(i[t+1].Zo())}}for(const i of this.nr(t))i.hr(s);this.wo&&this.do===t&&(this.wo.disconnect(),this.wo.connect(s))}rr(){return this.Yh}ar(){return this.Mn}cr(){return this.Xh}lr(){return this.Jh}ur(){return this.Kh}dr(){return this.oo}wr(){return this.Zh}pr(){return this.Qh}mr(){return this.so}yr(){return this.io}gr(){return this.eo}ae(t){this.h.ae(t)}ce(t){this.h.ce(t)}vr(t){let s=0;for(let i=0,e=this.Vh.length;i<e;++i){const e=this.Vh[i];this.Vh[s]=e,e.br()===t?e.et():++s}this.Vh.length=s}_r(){let t=0;for(let s=0,i=this.Bh.length;s<i;++s){const i=this.Bh[s];this.Bh[t]=i,i.Sr()&&i!==this.ro?i.et():++t}this.Bh.length=t}*kr(t){if(t.length>0)for(const s of this.Vh)this.qo(s.Or(),t)&&(yield s);else this.jh&&!this.jh.Pr()&&(yield this.jh)}*nr(t){if(t)for(const s of this.Vh)self.Fh.Yo(s.Mr(),t)&&(yield s);else this.jh&&!this.jh.Pr()&&(yield this.jh)}async zo(t,s,i,e,n){for(const t of this.Bh)if(t.Rr()===s)return e&&this.oo&&(this.ro=t),await t.Cr(),t;if(n)return null;e&&this.oo&&this._r();const h=self.Ir.Tr(this,t,s,i,e);return this.Bh.push(h),e&&this.oo&&(this.ro=h),await h.Cr(),this.$h.has(t)||(this._("buffer-metadata",{originalUrl:t,duration:h.Ar()}),this.$h.add(t)),h}async Er(t,s,i,e,n){for(const t of this.Vh)if(t.Rr()===s&&(t.Gr()||n))return n&&this.oo&&(this.ro=t.br()),t.Fr(e),t;const h=await this.zo(t,s,i,n);if(h.Lr())throw new Error(`buffer '${t}' unloaded while loading`);const o=h.Dr(e);return this.Vh.push(o),o}Wr(t){const s=t.join(" ");let i=this.qh.get(s);if(!i){let t=null;i={Ur:0,promise:new Promise(s=>t=s),resolve:t},this.qh.set(s,i)}i.Ur++}Hr(t){const s=t.join(" "),i=this.qh.get(s);if(!i)throw new Error("expected pending tag");i.Ur--,0===i.Ur&&(i.resolve(),this.qh.delete(s))}Br(t){const s=(0===t.length?this.Nh:t).join(" "),i=this.qh.get(s);return i?i.promise:Promise.resolve()}Vr(){if(this.co.size>0)this.L();else for(const t of this.Vh)if(t.jr())return void this.L()}m(){for(const t of this.co)t.m();const t=this.$o();for(const s of this.Vh)s.m(t);const s=this.Vh.filter(t=>t.jr()).map(t=>t.Nr());this._("state",{tickCount:this.zh,outputLatency:this.Lh.outputLatency||0,audioInstances:s,analysers:[...this.co].map(t=>t.$r())}),0===s.length&&0===this.co.size&&this.W()}zr(t,s,i){this._("trigger",{type:t,tags:s,aiid:i})}async vo(t){const s=t.originalUrl,i=t.url,e=t.type,n=t.isMusic,h=t.tags,o=t.isLooping,r=t.vol,a=t.pos,c=t.panning,l=t.stereoPan;let u=t.off;u>0&&!t.trueClock&&(u+=this.$o()),this.Nh=h.slice(0),this.Wr(h);try{this.jh=await this.Er(s,i,e,h,n),c?(this.jh.qr(!0),this.jh.Yr(c.x,c.y,c.z,c.angle,c.innerAngle,c.outerAngle,c.outerGain),c.hasOwnProperty("uid")&&this.jh.Xr(c.uid)):"number"==typeof l&&0!==l?(this.jh.Jr(!0),this.jh.Kr(l)):(this.jh.qr(!1),this.jh.Jr(!1)),this.jh.Play(o,r,a,u)}catch(t){return void console.error("[Construct] Audio: error starting playback: ",t)}finally{this.Hr(h)}this.L()}bo(t){const s=t.tags;for(const t of this.kr(s))t.Zr()}_o(){for(const t of this.Vh)t.Zr()}So(t){const s=t.tags,i=t.paused;for(const t of this.kr(s))i?t.Qr():t.ta();this.Vr()}ko(t){const s=t.tags,i=t.vol;for(const t of this.kr(s))t.sa(i)}To(t){const s=t.tags,i=t.p;for(const t of this.kr(s))t.Jr(!0),t.Kr(i)}async Oo(t){const s=t.tags,i=t.vol,e=t.duration,n=t.stopOnEnd;await this.Br(s);for(const t of this.kr(s))t.ia(i,e,n);this.Vr()}Po(t){this.Yh=t.vol,this.Dh.gain.value=this.Yh}Mo(t){const s=t.tags,i=t.isMuted;for(const t of this.kr(s))t.ea(i)}Ro(t){this.Mn=t.isSilent,this.h.ue(this.Mn);for(const t of this.Vh)t.na()}Co(t){const s=t.tags,i=t.isLooping;for(const t of this.kr(s))t.ha(i)}async xo(t){const s=t.tags,i=t.rate;await this.Br(s);for(const t of this.kr(s))t.oa(i)}async Io(t){const s=t.tags,i=t.pos;await this.Br(s);for(const t of this.kr(s))t.ra(i)}async Ao(t){const s=t.originalUrl,i=t.url,e=t.type,n=t.isMusic;try{await this.Er(s,i,e,"",n)}catch(t){console.error("[Construct] Audio: error preloading: ",t)}}async Eo(t){const s=t.url,i=t.type,e=t.isMusic,n=await this.zo("",s,i,e,!0);if(!n)return;n.et(),this.ro===n&&(this.ro=null);const h=this.Bh.indexOf(n);-1!==h&&this.Bh.splice(h,1)}Go(){for(const t of this.Bh)t.et(),this.ro===t&&(this.ro=null);this.Bh.length=0}Fo(t){const s=t.isSuspended;!s&&this.Lh.resume&&this.Lh.resume();for(const t of this.Vh)t.aa(s);s&&this.Lh.suspend&&this.Lh.suspend()}Uo(t){if(this.Jh=t.timeScale,this.Kh=t.gameTime,this.zh=t.tickCount,0!==this.Xh)for(const t of this.Vh)t.ca();const s=t.listenerPos;!s||this.no[0]===s[0]&&this.no[1]===s[1]&&this.no[2]===s[2]||(this.no[0]=s[0],this.no[1]=s[1],this.no[2]=s[2],this.Lh.listener.setPosition(s[0],s[1],s[2]));const i=t.listenerOrientation;if(i&&(this.ho[0]!==i[0]||this.ho[1]!==i[1]||this.ho[2]!==i[2]||this.ho[3]!==i[3]||this.ho[4]!==i[4]||this.ho[5]!==i[5])){for(let t=0;t<6;++t)this.ho[t]=i[t];this.Lh.listener.setOrientation(...this.ho)}for(const s of t.instPans){const t=s.uid;for(const i of this.Vh)i.la()===t&&i.ua(s.x,s.y,s.z,s.angle)}}async Lo(t){const s=t.type,i=t.hasOwnProperty("tags")?t.tags:[t.tag],e=t.params;let n,h;if("convolution"===s)try{h=await this.zo(t.bufferOriginalUrl,t.bufferUrl,t.bufferType,!1)}catch(t){return void console.log("[Construct] Audio: error loading convolution: ",t)}for(const o of i){if("filter"===s)n=new self.da(this,...e);else if("delay"===s)n=new self.wa(this,...e);else if("convolution"===s)n=new self.fa(this,h.pa(),...e),n.ma(t.bufferOriginalUrl,t.bufferUrl,t.bufferType);else if("flanger"===s)n=new self.ya(this,...e);else if("phaser"===s)n=new self.ga(this,...e);else if("gain"===s)n=new self.va(this,...e);else if("stereopan"===s)n=new self.ba(this,...e);else if("tremolo"===s)n=new self._a(this,...e);else if("ringmod"===s)n=new self.Sa(this,...e);else if("distortion"===s)n=new self.ka(this,...e);else if("compressor"===s)n=new self.Oa(this,...e);else{if("analyser"!==s)throw new Error("invalid effect type");n=new self.Pa(this,...e)}this.Qo(o,n)}this.Ma()}Do(t){const s=t.tags,i=t.index,e=t.param,n=t.value,h=t.ramp,o=t.time;for(const t of s){const s=this.ao.get(t.toLowerCase());!s||i<0||i>=s.length||s[i].Ra(e,n,h,o)}this.Ma()}Wo(t){const s=t.tags;for(const t of s){const s=t.toLowerCase(),i=this.ao.get(s);if(!i||!i.length)return;for(const t of i)t.et();this.ao.delete(s),this.ir(s)}}Ca(t){this.co.add(t),this.Vr()}xa(t){this.co.delete(t)}Ma(){this.lo||(this.lo=!0,Promise.resolve().then(()=>this.Ta()))}Ta(){const t={};for(const[s,i]of this.ao)t[s]=i.map(t=>t.Nr());this._("fxstate",{fxstate:t}),this.lo=!1}async Ho(t){const s=t.saveLoadMode;if(3!==s){const t=[];for(const i of this.Vh)i.Sr()&&1===s||!i.Sr()&&2===s?t.push(i):i.et();this.Vh=t}for(const t of this.ao.values())for(const s of t)s.et();this.ao.clear(),this.Jh=t.timeScale,this.Kh=t.gameTime;const i=t.listenerPos;this.no[0]=i[0],this.no[1]=i[1],this.no[2]=i[2],this.Lh.listener.setPosition(i[0],i[1],i[2]);const e=t.listenerOrientation;if(Array.isArray(e)){for(let t=0;t<6;++t)this.ho[t]=e[t];this.Lh.listener.setOrientation(...this.ho)}this.Mn=t.isSilent,this.h.ue(this.Mn),this.Yh=t.masterVolume,this.Dh.gain.value=this.Yh;const n=[];for(const s of Object.values(t.effects))n.push(Promise.all(s.map(t=>this.Lo(t))));await Promise.all(n),await Promise.all(t.playing.map(t=>this.Ia(t,s))),this.Vr()}async Ia(t,s){if(3===s)return;const i=t.bufferOriginalUrl,e=t.bufferUrl,n=t.bufferType,h=t.isMusic,o=t.tags,r=t.isLooping,a=t.volume,c=t.playbackTime;if(h&&1===s)return;if(!h&&2===s)return;let l=null;try{l=await this.Er(i,e,n,o,h)}catch(t){return void console.error("[Construct] Audio: error loading audio state: ",t)}l.Aa(t.pan),l.Ea(t.stereoPan),l.Play(r,a,c,0),t.isPlaying||l.Qr(),l.Ga(t)}fo(t,s){this.wo&&this.wo.disconnect(),this.do=s.toLowerCase(),this.wo=this.Lh.createMediaStreamSource(t),this.wo.connect(this.Ko(this.do))}mo(){return this.po||(this.po=this.Lh.createMediaStreamDestination(),this.Dh.connect(this.po)),this.po.stream}async Bo(t){try{const s=t.time,i=this.Lh.suspend(s);this.uo?this.Lh.resume():(this.Lh.startRendering().then(t=>this.Fa(t)).catch(t=>this.La(t)),this.uo=!0),await i}catch(t){this.La(t)}}Vo(){this.Lh.resume()}Fa(t){const s=[];for(let i=0,e=t.numberOfChannels;i<e;++i){const e=t.getChannelData(i);s.push(e.buffer)}this.h.S("runtime","offline-audio-render-completed",{duration:t.duration,length:t.length,numberOfChannels:t.numberOfChannels,sampleRate:t.sampleRate,channelData:s},null,s)}La(t){console.error("[Audio] Offline rendering error: ",t)}static Yo(t,s){return t===s||t.normalize().toLowerCase()===s.normalize().toLowerCase()}static Da(t){return t*K}static Wa(t){return Math.pow(10,t/20)}static Ua(t){return Math.max(Math.min(self.Fh.Wa(t),1),0)}static Ha(t){return Math.log(t)/Math.log(10)*20}static Ba(t){return self.Fh.Ha(Math.max(Math.min(t,1),0))}static Va(t,s){return 1-Math.exp(-s*t)}},self.ss.ne(self.Fh)}self.Ir=class{constructor(t,s,i,e,n){this.ja=t,this.Na=s,this.$a=i,this.za=e,this.qa=n,this.Ya="",this.Xa="not-loaded",this.Ja=null}et(){this.Xa="not-loaded",this.ja=null,this.Ja=null}Lr(){return!this.ja}static Tr(t,s,i,e,n){return!n||t.dr()?new self.Ka(t,s,i,e,n):new self.Za(t,s,i,e,n)}Dr(t){return"html5"===this.Ya?new self.Qa(this.ja,this,t):new self.tc(this.ja,this,t)}sc(){}Cr(){return this.Ja||(this.Ja=this.sc()),this.Ja}ec(){}nc(){}hc(){return"failed"===this.Xa}Xo(){return this.ja.Xo()}oc(){return this.Ya}rc(){return this.Na}Rr(){return this.$a}ac(){return this.za}Sr(){return this.qa}Ar(){}},self.Za=class extends self.Ir{constructor(t,s,i,e,n){super(t,s,i,e,n),this.Ya="html5",this.cc=new Audio,this.cc.crossOrigin="anonymous",this.cc.autoplay=!1,this.cc.preload="auto",this.lc=null,this.uc=null,this.dc=!1,this.cc.addEventListener("canplaythrough",()=>this.dc=!0),this.wc=this.Xo().createGain(),this.fc=null,this.cc.addEventListener("canplay",()=>{this.lc&&(this.Xa="loaded",this.lc(),this.lc=null,this.uc=null),!this.fc&&this.cc&&(this.fc=this.Xo().createMediaElementSource(this.cc),this.fc.connect(this.wc))}),this.onended=null,this.cc.addEventListener("ended",()=>{this.onended&&this.onended()}),this.cc.addEventListener("error",t=>this.mc(t))}et(){this.ja.vr(this),this.wc.disconnect(),this.wc=null,this.fc.disconnect(),this.fc=null,this.cc&&!this.cc.paused&&this.cc.pause(),this.onended=null,this.cc=null,super.et()}sc(){return this.Xa="loading",new Promise((t,s)=>{this.lc=t,this.uc=s,this.cc.src=this.$a})}mc(t){console.error(`[Construct] Audio '${this.$a}' error: `,t),this.uc&&(this.Xa="failed",this.uc(t),this.lc=null,this.uc=null)}ec(){const t=this.cc.readyState>=4;return t&&(this.dc=!0),t||this.dc}nc(){return this.ec()}yc(){return this.cc}vc(){return this.wc}Ar(){return this.cc.duration}},self.Ka=class extends self.Ir{constructor(t,s,i,e,n){super(t,s,i,e,n),this.Ya="webaudio",this.bc=null,this._c=null}et(){this.ja.vr(this),this.bc=null,this._c=null,super.et()}async Sc(){if(this.bc)return this.bc;const t=this.ja.G();if("cordova"===t.Ks()&&t.me(this.$a)&&t.Zs())this.bc=await t.Ji(this.$a);else if("playable-ad-single-file"===t.Ks()&&t.me(this.$a)){const s=t._PlayableAdFetchBlob(this.$a);this.bc=await s.arrayBuffer()}else{const t=await fetch(this.$a);if(!t.ok)throw new Error(`error fetching audio data: ${t.status} ${t.statusText}`);this.bc=await t.arrayBuffer()}}async kc(){if(this._c)return this._c;const t=this.ja.Xo();this._c=await t.decodeAudioData(this.bc),this.bc=null}async sc(){try{if(this.Xa="loading",await this.Sc(),this.Lr())return;await this.kc(),this.Xa="loaded"}catch(t){this.Xa="failed",console.error(`[Construct] Failed to load audio '${this.$a}': `,t)}}ec(){return!(!this.bc&&!this._c)}nc(){return!!this._c}pa(){return this._c}Ar(){return this._c?this._c.duration:0}};{let Q=0;self.Oc=class{constructor(t,s,i){this.ja=t,this.Pc=s,this.Mc=i,this.Rc=this.Mr(),this.Cc=Q++,this.xc=this.Xo().createGain(),this.xc.connect(this.Jo()),this.Tc=null,this.Ic=!1,this.Ac=[0,0,0],this.Ec=[0,0,0],this.Gc=[0,0,0],this.Fc=null,this.Lc=!1,this.Dc=0,this.Wc=!0,this.Uc=!1,this.Hc=!1,this.Bc=!1,this.Vc=1,this.jc=!1,this.Nc=1;const e=this.ja.cr();this.$c=1===e&&!this.Sr()||2===e,this.zc=-1,this.qc=-1,this.Yc=!1}et(){this.ja=null,this.Pc=null,this.Tc&&(this.Tc.disconnect(),this.Tc=null),this.Fc&&(this.Fc.disconnect(),this.Fc=null),this.xc.disconnect(),this.xc=null}Xo(){return this.ja.Xo()}Fr(t){this.Mc=t;const s=this.Mr();this.Rc!==s&&(this.Rc=s,this.hr(this.Jo()))}Or(){return this.Mc}Mr(){return this.Mc.length>0?this.Mc[0]:""}Jo(){return this.ja.Ko(this.Mr())}Xc(){return this.$c?this.ja.ur():performance.now()/1e3}rc(){return this.Pc.rc()}Rr(){return this.Pc.Rr()}ac(){return this.Pc.ac()}br(){return this.Pc}Sr(){return this.Pc.Sr()}Jc(){return this.Cc}Pr(){}Gr(){}IsPlaying(){return!this.Wc&&!this.Uc&&!this.Pr()}jr(){return!this.Wc&&!this.Pr()}Kc(){}Ar(t){let s=this.Pc.Ar();return t&&(s/=this.Nc||.001),s}Play(t,s,i,e){}Zr(){}Qr(){}Zc(){return this.Uc}ta(){}sa(t){this.Vc=t,this.xc.gain.cancelScheduledValues(0),this.qc=-1,this.xc.gain.value=this.Qc()}ia(t,s,i){if(this.tl())return;const e=this.xc.gain;e.cancelScheduledValues(0);const n=this.ja.$o(),h=n+s;e.setValueAtTime(e.value,n),e.linearRampToValueAtTime(t,h),this.Vc=t,this.qc=h,this.Yc=i}sl(){this.sa(this.Vc)}m(t){-1!==this.qc&&t>=this.qc&&(this.qc=-1,this.Yc&&this.Zr(),this.ja.zr("fade-ended",this.Mc,this.Cc))}Qc(){const t=this.Vc;return isFinite(t)?t:0}ea(t){t=!!t,this.jc!==t&&(this.jc=t,this.na())}tl(){return this.jc}ar(){return this.ja.ar()}na(){}ha(t){}il(){return this.Bc}oa(t){this.Nc!==t&&(this.Nc=t,this.ca())}ca(){}el(){return this.Nc}ra(t){}aa(t){}qr(t){t=!!t,this.Ic!==t&&(this.Ic=t,this.Ic?(this.Jr(!1),this.Tc||(this.Tc=this.Xo().createPanner(),this.Tc.panningModel=this.ja.wr(),this.Tc.distanceModel=this.ja.pr(),this.Tc.refDistance=this.ja.mr(),this.Tc.maxDistance=this.ja.yr(),this.Tc.rolloffFactor=this.ja.gr()),this.xc.disconnect(),this.xc.connect(this.Tc),this.Tc.connect(this.Jo())):(this.Tc.disconnect(),this.xc.disconnect(),this.xc.connect(this.Jo())))}Yr(t,s,i,e,n,h,o){if(!this.Ic)return;this.ua(t,s,i,e);const r=self.Fh.Da;this.Gc[0]!==r(n)&&(this.Gc[0]=r(n),this.Tc.coneInnerAngle=r(n)),this.Gc[1]!==r(h)&&(this.Gc[1]=r(h),this.Tc.coneOuterAngle=r(h)),this.Gc[2]!==o&&(this.Gc[2]=o,this.Tc.coneOuterGain=o)}ua(t,s,i,e){if(!this.Ic)return;const n=this.Ac,h=this.Ec,o=Math.cos(e),r=Math.sin(e);n[0]===t&&n[1]===s&&n[2]===i||(n[0]=t,n[1]=s,n[2]=i,this.Tc.setPosition(...n)),h[0]===o&&h[1]===r&&0===h[2]||(h[0]=o,h[1]=r,h[2]=0,this.Tc.setOrientation(...h))}Jr(t){t=!!t,this.Lc!==t&&(this.Lc=t,this.Lc?(this.qr(!1),this.Fc=this.Xo().createStereoPanner(),this.xc.disconnect(),this.xc.connect(this.Fc),this.Fc.connect(this.Jo())):(this.Fc.disconnect(),this.Fc=null,this.xc.disconnect(),this.xc.connect(this.Jo())))}Kr(t){this.Lc&&this.Dc!==t&&(this.Fc.pan.value=t,this.Dc=t)}Xr(t){this.zc=t}la(){return this.zc}nl(){}hr(t){const s=this.Fc||this.Tc||this.xc;s.disconnect(),s.connect(t)}Nr(){return{aiid:this.Jc(),tags:this.Mc,duration:this.Ar(),volume:-1===this.qc?this.Vc:this.xc.gain.value,isPlaying:this.IsPlaying(),playbackTime:this.Kc(),playbackRate:this.el(),uid:this.zc,bufferOriginalUrl:this.rc(),bufferUrl:"",bufferType:this.ac(),isMusic:this.Sr(),isLooping:this.il(),isMuted:this.tl(),resumePosition:this.nl(),pan:this.hl(),stereoPan:this.ol()}}Ga(t){this.oa(t.playbackRate),this.ea(t.isMuted)}hl(){if(!this.Tc)return null;const t=this.Tc;return{pos:this.Ac,orient:this.Ec,cia:t.coneInnerAngle,coa:t.coneOuterAngle,cog:t.coneOuterGain,uid:this.zc}}Aa(t){if(!t)return void this.qr(!1);this.qr(!0);const s=this.Tc,i=t.pos;this.Ac[0]=i[0],this.Ac[1]=i[1],this.Ac[2]=i[2];const e=t.orient;this.Ec[0]=e[0],this.Ec[1]=e[1],this.Ec[2]=e[2],s.setPosition(...this.Ac),s.setOrientation(...this.Ec),this.Gc[0]=t.cia,this.Gc[1]=t.coa,this.Gc[2]=t.cog,s.coneInnerAngle=t.cia,s.coneOuterAngle=t.coa,s.coneOuterGain=t.cog,this.zc=t.uid}ol(){return this.Fc?this.Dc:null}Ea(t){"number"==typeof t?(this.Jr(!0),this.Kr(t)):this.Jr(!1)}}}self.Qa=class extends self.Oc{constructor(t,s,i){super(t,s,i),this.Pc.vc().connect(this.xc),this.Pc.onended=()=>this.rl()}et(){this.Zr(),this.Pc.vc().disconnect(),super.et()}yc(){return this.Pc.yc()}rl(){this.Wc=!0,this.zc=-1,this.ja.zr("ended",this.Mc,this.Cc)}Pr(){return this.yc().ended}Gr(){return!!this.Wc||this.Pr()}Kc(){let t=this.yc().currentTime;return this.Bc||(t=Math.min(t,this.Ar())),t}Play(t,s,i,e){const n=this.yc();if(1!==n.playbackRate&&(n.playbackRate=1),n.loop!==t&&(n.loop=t),this.sa(s),this.jc=!1,n.muted&&(n.muted=!1),n.currentTime!==i)try{n.currentTime=i}catch(t){console.warn(`[Construct] Exception seeking audio '${this.Pc.Rr()}' to position '${i}': `,t)}this.ja.ae(n),this.Wc=!1,this.Uc=!1,this.Bc=t,this.Nc=1}Zr(){const t=this.yc();t.paused||t.pause(),this.ja.ce(t),this.Wc=!0,this.Uc=!1,this.zc=-1}Qr(){if(this.Uc||this.Wc||this.Pr())return;const t=this.yc();t.paused||t.pause(),this.ja.ce(t),this.Uc=!0}ta(){!this.Uc||this.Wc||this.Pr()||(this.ja.ae(this.yc()),this.Uc=!1)}na(){this.yc().muted=this.jc||this.ar()}ha(t){t=!!t,this.Bc!==t&&(this.Bc=t,this.yc().loop=t)}ca(){let t=this.Nc;this.$c&&(t*=this.ja.lr());try{this.yc().playbackRate=t}catch(s){console.warn(`[Construct] Unable to set playback rate '${t}':`,s)}}ra(t){if(!this.Wc&&!this.Pr())try{this.yc().currentTime=t}catch(s){console.warn(`[Construct] Error seeking audio to '${t}': `,s)}}nl(){return this.Kc()}aa(t){t?this.IsPlaying()?(this.yc().pause(),this.Hc=!0):this.Hc=!1:this.Hc&&(this.ja.ae(this.yc()),this.Hc=!1)}},self.tc=class extends self.Oc{constructor(t,s,i){super(t,s,i),this.al=null,this.cl=t=>this.rl(t),this.ll=!0,this.ul=null,this.dl=0,this.wl=0,this.fl=0,this.pl=1}et(){this.Zr(),this.ml(),this.cl=null,super.et()}ml(){this.al&&(this.al.onended=null,this.al.disconnect(),this.al.buffer=null),this.al=null,this.ul=null}rl(t){this.Uc||this.Hc||t.target===this.ul&&(this.ll=!0,this.Wc=!0,this.zc=-1,this.ml(),this.ja.zr("ended",this.Mc,this.Cc))}Pr(){return!(!this.Wc&&this.al&&this.al.loop)&&!this.Uc&&this.ll}Gr(){return!(this.al&&!this.Wc)||this.Pr()}Kc(){let t=0;return t=this.Uc?this.fl:this.wl+(this.Xc()-this.dl)*this.Nc,this.Bc||(t=Math.min(t,this.Ar())),t}Play(t,s,i,e){this.jc=!1,this.pl=1,this.sa(s),this.ml(),this.al=this.Xo().createBufferSource(),this.al.buffer=this.Pc.pa(),this.al.connect(this.xc),this.ul=this.al,this.al.onended=this.cl,this.al.loop=t,this.al.start(e,i),this.ll=!1,this.Wc=!1,this.Uc=!1,this.Bc=t,this.Nc=1,this.dl=this.Xc(),this.wl=i}Zr(){if(this.al)try{this.al.stop(0)}catch(t){}this.Wc=!0,this.Uc=!1,this.zc=-1}Qr(){this.Uc||this.Wc||this.Pr()||(this.fl=this.Kc(),this.Bc&&(this.fl%=this.Ar()),this.Uc=!0,this.al.stop(0))}ta(){!this.Uc||this.Wc||this.Pr()||(this.ml(),this.al=this.Xo().createBufferSource(),this.al.buffer=this.Pc.pa(),this.al.connect(this.xc),this.ul=this.al,this.al.onended=this.cl,this.al.loop=this.Bc,this.sl(),this.ca(),this.al.start(0,this.fl),this.dl=this.Xc(),this.wl=this.fl,this.Uc=!1)}Qc(){return super.Qc()*this.pl}na(){this.pl=this.jc||this.ar()?0:1,this.sl()}ha(t){t=!!t,this.Bc!==t&&(this.Bc=t,this.al&&(this.al.loop=t))}ca(){let t=this.Nc;this.$c&&(t*=this.ja.lr()),this.al&&(this.al.playbackRate.value=t)}ra(t){this.Wc||this.Pr()||(this.Uc?this.fl=t:(this.Qr(),this.fl=t,this.ta()))}nl(){return this.fl}aa(t){t?this.IsPlaying()?(this.Hc=!0,this.fl=this.Kc(),this.Bc&&(this.fl%=this.Ar()),this.al.stop(0)):this.Hc=!1:this.Hc&&(this.ml(),this.al=this.Xo().createBufferSource(),this.al.buffer=this.Pc.pa(),this.al.connect(this.xc),this.ul=this.al,this.al.onended=this.cl,this.al.loop=this.Bc,this.sl(),this.ca(),this.al.start(0,this.fl),this.dl=this.Xc(),this.wl=this.fl,this.Hc=!1)}Ga(t){super.Ga(t),this.fl=t.resumePosition}};{class tt{constructor(t){this.ja=t,this.Lh=t.Xo(),this.yl=-1,this.gl="",this.za="",this.vl=null}et(){this.Lh=null}tr(t){this.yl=t}bl(){return this.yl}sr(t){this.gl=t}_l(){return this.gl}Sl(){return this.Lh.createGain()}Zo(){}er(t){}kl(t,s,i,e){if(t.cancelScheduledValues(0),0===e)return void(t.value=s);const n=this.Lh.currentTime;switch(e+=n,i){case 0:t.setValueAtTime(s,e);break;case 1:t.setValueAtTime(t.value,n),t.linearRampToValueAtTime(s,e);break;case 2:t.setValueAtTime(t.value,n),t.exponentialRampToValueAtTime(s,e)}}Nr(){return{type:this.za,tag:this.gl,params:this.vl}}}self.da=class extends tt{constructor(t,s,i,e,n,h,o){super(t),this.za="filter",this.vl=[s,i,e,n,h,o],this.Ol=this.Sl(),this.Pl=this.Sl(),this.Pl.gain.value=o,this.Ml=this.Sl(),this.Ml.gain.value=1-o,this.Rl=this.Lh.createBiquadFilter(),this.Rl.type=s,this.Rl.frequency.value=i,this.Rl.detune.value=e,this.Rl.Q.value=n,this.Rl.gain.vlaue=h,this.Ol.connect(this.Rl),this.Ol.connect(this.Ml),this.Rl.connect(this.Pl)}et(){this.Ol.disconnect(),this.Rl.disconnect(),this.Pl.disconnect(),this.Ml.disconnect(),super.et()}er(t){this.Pl.disconnect(),this.Pl.connect(t),this.Ml.disconnect(),this.Ml.connect(t)}Zo(){return this.Ol}Ra(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.vl[5]=s,this.kl(this.Pl.gain,s,i,e),this.kl(this.Ml.gain,1-s,i,e);break;case 1:this.vl[1]=s,this.kl(this.Rl.frequency,s,i,e);break;case 2:this.vl[2]=s,this.kl(this.Rl.detune,s,i,e);break;case 3:this.vl[3]=s,this.kl(this.Rl.Q,s,i,e);break;case 4:this.vl[4]=s,this.kl(this.Rl.gain,s,i,e)}}},self.wa=class extends tt{constructor(t,s,i,e){super(t),this.za="delay",this.vl=[s,i,e],this.Ol=this.Sl(),this.Pl=this.Sl(),this.Pl.gain.value=e,this.Ml=this.Sl(),this.Ml.gain.value=1-e,this.Cl=this.Sl(),this.xl=this.Lh.createDelay(s),this.xl.delayTime.value=s,this.Tl=this.Sl(),this.Tl.gain.value=i,this.Ol.connect(this.Cl),this.Ol.connect(this.Ml),this.Cl.connect(this.Pl),this.Cl.connect(this.xl),this.xl.connect(this.Tl),this.Tl.connect(this.Cl)}et(){this.Ol.disconnect(),this.Pl.disconnect(),this.Ml.disconnect(),this.Cl.disconnect(),this.xl.disconnect(),this.Tl.disconnect(),super.et()}er(t){this.Pl.disconnect(),this.Pl.connect(t),this.Ml.disconnect(),this.Ml.connect(t)}Zo(){return this.Ol}Ra(t,s,i,e){const n=self.Fh.Ua;switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.vl[2]=s,this.kl(this.Pl.gain,s,i,e),this.kl(this.Ml.gain,1-s,i,e);break;case 4:this.vl[1]=n(s),this.kl(this.Tl.gain,n(s),i,e);break;case 5:this.vl[0]=s,this.kl(this.xl.delayTime,s,i,e)}}},self.fa=class extends tt{constructor(t,s,i,e){super(t),this.za="convolution",this.vl=[i,e],this.Il="",this.Al="",this.El="",this.Ol=this.Sl(),this.Pl=this.Sl(),this.Pl.gain.value=e,this.Ml=this.Sl(),this.Ml.gain.value=1-e,this.Gl=this.Lh.createConvolver(),this.Gl.normalize=i,this.Gl.buffer=s,this.Ol.connect(this.Gl),this.Ol.connect(this.Ml),this.Gl.connect(this.Pl)}et(){this.Ol.disconnect(),this.Gl.disconnect(),this.Pl.disconnect(),this.Ml.disconnect(),super.et()}er(t){this.Pl.disconnect(),this.Pl.connect(t),this.Ml.disconnect(),this.Ml.connect(t)}Zo(){return this.Ol}Ra(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.vl[1]=s,this.kl(this.Pl.gain,s,i,e),this.kl(this.Ml.gain,1-s,i,e))}ma(t,s,i){this.Il=t,this.Al=s,this.El=i}Nr(){const t=super.Nr();return t.bufferOriginalUrl=this.Il,t.bufferUrl="",t.bufferType=this.El,t}},self.ya=class extends tt{constructor(t,s,i,e,n,h){super(t),this.za="flanger",this.vl=[s,i,e,n,h],this.Ol=this.Sl(),this.Ml=this.Sl(),this.Ml.gain.value=1-h/2,this.Pl=this.Sl(),this.Pl.gain.value=h/2,this.Fl=this.Sl(),this.Fl.gain.value=n,this.xl=this.Lh.createDelay(s+i),this.xl.delayTime.value=s,this.Ll=this.Lh.createOscillator(),this.Ll.frequency.value=e,this.Dl=this.Sl(),this.Dl.gain.value=i,this.Ol.connect(this.xl),this.Ol.connect(this.Ml),this.xl.connect(this.Pl),this.xl.connect(this.Fl),this.Fl.connect(this.xl),this.Ll.connect(this.Dl),this.Dl.connect(this.xl.delayTime),this.Ll.start(0)}et(){this.Ll.stop(0),this.Ol.disconnect(),this.xl.disconnect(),this.Ll.disconnect(),this.Dl.disconnect(),this.Ml.disconnect(),this.Pl.disconnect(),this.Fl.disconnect(),super.et()}er(t){this.Pl.disconnect(),this.Pl.connect(t),this.Ml.disconnect(),this.Ml.connect(t)}Zo(){return this.Ol}Ra(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.vl[4]=s,this.kl(this.Pl.gain,s/2,i,e),this.kl(this.Ml.gain,1-s/2,i,e);break;case 6:this.vl[1]=s/1e3,this.kl(this.Dl.gain,s/1e3,i,e);break;case 7:this.vl[2]=s,this.kl(this.Ll.frequency,s,i,e);break;case 8:this.vl[3]=s/100,this.kl(this.Fl.gain,s/100,i,e)}}},self.ga=class extends tt{constructor(t,s,i,e,n,h,o){super(t),this.za="phaser",this.vl=[s,i,e,n,h,o],this.Ol=this.Sl(),this.Ml=this.Sl(),this.Ml.gain.value=1-o/2,this.Pl=this.Sl(),this.Pl.gain.value=o/2,this.Rl=this.Lh.createBiquadFilter(),this.Rl.type="allpass",this.Rl.frequency.value=s,this.Rl.detune.value=i,this.Rl.Q.value=e,this.Ll=this.Lh.createOscillator(),this.Ll.frequency.value=h,this.Dl=this.Sl(),this.Dl.gain.value=n,this.Ol.connect(this.Rl),this.Ol.connect(this.Ml),this.Rl.connect(this.Pl),this.Ll.connect(this.Dl),this.Dl.connect(this.Rl.frequency),this.Ll.start(0)}et(){this.Ll.stop(0),this.Ol.disconnect(),this.Rl.disconnect(),this.Ll.disconnect(),this.Dl.disconnect(),this.Ml.disconnect(),this.Pl.disconnect(),super.et()}er(t){this.Pl.disconnect(),this.Pl.connect(t),this.Ml.disconnect(),this.Ml.connect(t)}Zo(){return this.Ol}Ra(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.vl[5]=s,this.kl(this.Pl.gain,s/2,i,e),this.kl(this.Ml.gain,1-s/2,i,e);break;case 1:this.vl[0]=s,this.kl(this.Rl.frequency,s,i,e);break;case 2:this.vl[1]=s,this.kl(this.Rl.detune,s,i,e);break;case 3:this.vl[2]=s,this.kl(this.Rl.Q,s,i,e);break;case 6:this.vl[3]=s,this.kl(this.Dl.gain,s,i,e);break;case 7:this.vl[4]=s,this.kl(this.Ll.frequency,s,i,e)}}},self.va=class extends tt{constructor(t,s){super(t),this.za="gain",this.vl=[s],this.Wl=this.Sl(),this.Wl.gain.value=s}et(){this.Wl.disconnect(),super.et()}er(t){this.Wl.disconnect(),this.Wl.connect(t)}Zo(){return this.Wl}Ra(t,s,i,e){const n=self.Fh.Ua;4===t&&(this.vl[0]=n(s),this.kl(this.Wl.gain,n(s),i,e))}},self.ba=class extends tt{constructor(t,s){super(t),this.za="stereopan",this.vl=[s],this.Wl=this.Lh.createStereoPanner(),this.Wl.pan.value=s}et(){this.Wl.disconnect(),super.et()}er(t){this.Wl.disconnect(),this.Wl.connect(t)}Zo(){return this.Wl}Ra(t,s,i,e){s=Math.min(Math.max(s/100,-1),1),9===t&&(this.vl[0]=s,this.kl(this.Wl.pan,s,i,e))}},self._a=class extends tt{constructor(t,s,i){super(t),this.za="tremolo",this.vl=[s,i],this.Wl=this.Sl(),this.Wl.gain.value=1-i/2,this.Ll=this.Lh.createOscillator(),this.Ll.frequency.value=s,this.Dl=this.Sl(),this.Dl.gain.value=i/2,this.Ll.connect(this.Dl),this.Dl.connect(this.Wl.gain),this.Ll.start(0)}et(){this.Ll.stop(0),this.Ll.disconnect(),this.Dl.disconnect(),this.Wl.disconnect(),super.et()}er(t){this.Wl.disconnect(),this.Wl.connect(t)}Zo(){return this.Wl}Ra(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.vl[1]=s,this.kl(this.Wl.gain,1-s/2,i,e),this.kl(this.Dl.gain,s/2,i,e);break;case 7:this.vl[0]=s,this.kl(this.Ll.frequency,s,i,e)}}},self.Sa=class extends tt{constructor(t,s,i){super(t),this.za="ringmod",this.vl=[s,i],this.Ol=this.Sl(),this.Pl=this.Sl(),this.Pl.gain.value=i,this.Ml=this.Sl(),this.Ml.gain.value=1-i,this.Ul=this.Sl(),this.Ul.gain.value=0,this.Ll=this.Lh.createOscillator(),this.Ll.frequency.value=s,this.Ll.connect(this.Ul.gain),this.Ll.start(0),this.Ol.connect(this.Ul),this.Ol.connect(this.Ml),this.Ul.connect(this.Pl)}et(){this.Ll.stop(0),this.Ll.disconnect(),this.Ul.disconnect(),this.Ol.disconnect(),this.Pl.disconnect(),this.Ml.disconnect(),super.et()}er(t){this.Pl.disconnect(),this.Pl.connect(t),this.Ml.disconnect(),this.Ml.connect(t)}Zo(){return this.Ol}Ra(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.vl[1]=s,this.kl(this.Pl.gain,s,i,e),this.kl(this.Ml.gain,1-s,i,e);break;case 7:this.vl[0]=s,this.kl(this.Ll.frequency,s,i,e)}}},self.ka=class extends tt{constructor(t,s,i,e,n,h){super(t),this.za="distortion",this.vl=[s,i,e,n,h],this.Ol=this.Sl(),this.Hl=this.Sl(),this.Bl=this.Sl(),this.Vl(e,n),this.Pl=this.Sl(),this.Pl.gain.value=h,this.Ml=this.Sl(),this.Ml.gain.value=1-h,this.jl=this.Lh.createWaveShaper(),this.Nl=new Float32Array(65536),this.$l(s,i),this.jl.curve=this.Nl,this.Ol.connect(this.Hl),this.Ol.connect(this.Ml),this.Hl.connect(this.jl),this.jl.connect(this.Bl),this.Bl.connect(this.Pl)}et(){this.Ol.disconnect(),this.Hl.disconnect(),this.jl.disconnect(),this.Bl.disconnect(),this.Pl.disconnect(),this.Ml.disconnect(),super.et()}Vl(t,s){t<.01&&(t=.01),this.Hl.gain.value=t,this.Bl.gain.value=Math.pow(1/t,.6)*s}$l(t,s){const i=32768;for(let e=0;e<i;++e){let n=e/i;n=this.zl(n,t,s),this.Nl[i+e]=n,this.Nl[i-e-1]=-n}}zl(t,s,i){const e=1.05*i*s-s,n=t<0?-1:1,h=t<0?-t:t;let o=h<s?h:s+e*self.Fh.Va(h-s,1/e);return o*=n,o}er(t){this.Pl.disconnect(),this.Pl.connect(t),this.Ml.disconnect(),this.Ml.connect(t)}Zo(){return this.Ol}Ra(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.vl[4]=s,this.kl(this.Pl.gain,s,i,e),this.kl(this.Ml.gain,1-s,i,e))}},self.Oa=class extends tt{constructor(t,s,i,e,n,h){super(t),this.za="compressor",this.vl=[s,i,e,n,h],this.Wl=this.Lh.createDynamicsCompressor(),this.Wl.threshold.value=s,this.Wl.knee.value=i,this.Wl.ratio.value=e,this.Wl.attack.value=n,this.Wl.release.value=h}et(){this.Wl.disconnect(),super.et()}er(t){this.Wl.disconnect(),this.Wl.connect(t)}Zo(){return this.Wl}Ra(t,s,i,e){}},self.Pa=class extends tt{constructor(t,s,i){super(t),this.za="analyser",this.vl=[s,i],this.Wl=this.Lh.createAnalyser(),this.Wl.fftSize=s,this.Wl.smoothingTimeConstant=i,this.ql=new Float32Array(this.Wl.frequencyBinCount),this.Yl=new Uint8Array(s),this.Xl=0,this.Jl=0,this.ja.Ca(this)}et(){this.ja.xa(this),this.Wl.disconnect(),super.et()}m(){this.Wl.getFloatFrequencyData(this.ql),this.Wl.getByteTimeDomainData(this.Yl);const t=this.Wl.fftSize;this.Xl=0;let s=0;for(let i=0;i<t;++i){let t=(this.Yl[i]-128)/128;t<0&&(t=-t),this.Xl<t&&(this.Xl=t),s+=t*t}const i=self.Fh.Ba;this.Xl=i(this.Xl),this.Jl=i(Math.sqrt(s/t))}er(t){this.Wl.disconnect(),this.Wl.connect(t)}Zo(){return this.Wl}Ra(t,s,i,e){}$r(){return{tag:this._l(),index:this.bl(),peak:this.Xl,rms:this.Jl,binCount:this.Wl.frequencyBinCount,freqBins:this.ql}}}}if(window.C3_IsSupported){const st=!0;window.c3_runtimeInterface=new self.ss({ns:st,Ci:"workermain.js",Ai:["scripts/c3main.js"],ls:"scripts/",As:"html5"})}